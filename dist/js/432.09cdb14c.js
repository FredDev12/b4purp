"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[432],{939:(e,t,l)=>{l.d(t,{A:()=>E});var i=l(641),n=l(33),r=l(751);const o=l.p+"img/user1.8b23ecd3.png",s={class:"navbar"},a={class:"action-bubble"},u={class:"welcom"},d={key:0,class:"dropdown-menu"};function c(e,t,l,c,k,m){const h=(0,i.g2)("router-link");return(0,i.uX)(),(0,i.CE)("div",null,[(0,i.Lk)("header",s,[t[4]||(t[4]=(0,i.Lk)("div",{class:"logo"},[(0,i.Lk)("a",{href:"/"},"MonLogo")],-1)),(0,i.Lk)("div",{class:(0,n.C4)(["menu",{active:e.isMenuOpen}])},[(0,i.Lk)("ul",null,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.menuItems,(e=>((0,i.uX)(),(0,i.CE)("li",{key:e.name,class:(0,n.C4)({active:e.active})},[(0,i.bF)(h,{class:"link",to:e.link},{default:(0,i.k6)((()=>[(0,i.eW)((0,n.v_)(e.name),1)])),_:2},1032,["to"])],2)))),128))])],2),(0,i.Lk)("div",a,[(0,i.Lk)("h1",u,"Bonjour, "+(0,n.v_)(e.username)+" !",1),(0,i.Lk)("button",{onClick:t[0]||(t[0]=(...t)=>e.toggleDropdown&&e.toggleDropdown(...t)),class:"action-button"},t[3]||(t[3]=[(0,i.Lk)("img",{src:o,alt:"Profile",class:"profile-picture"},null,-1)])),e.isDropdownOpen?((0,i.uX)(),(0,i.CE)("div",d,[(0,i.Lk)("ul",null,[(0,i.Lk)("li",null,[(0,i.Lk)("a",{href:"#",onClick:t[1]||(t[1]=(0,r.D$)(((...t)=>e.profil&&e.profil(...t)),["prevent"]))},"Mon profil")]),(0,i.Lk)("li",null,[(0,i.Lk)("a",{href:"#",onClick:t[2]||(t[2]=(0,r.D$)(((...t)=>e.logout&&e.logout(...t)),["prevent"]))},"Se déconnecter")])])])):(0,i.Q3)("",!0)])])])}var k=l(220),m=l(866);const h=(0,i.pM)({name:"NavbarComponent",props:{menuItems:{type:Array,required:!0}},setup(){const e=(0,k.rd)(),t=(0,m.P)(),l=t.userProfile?t.userProfile.name:"Default Name",i=()=>{localStorage.removeItem("token"),localStorage.removeItem("username"),localStorage.removeItem("role"),e.push("/")},n=()=>{e.push({name:"profile"})};return{logout:i,profil:n,username:l}},data(){return{isMenuOpen:!1,isDropdownOpen:!1}},methods:{toggleMenu(){this.isMenuOpen=!this.isMenuOpen},toggleDropdown(){this.isDropdownOpen=!this.isDropdownOpen}}});var p=l(262);const L=(0,p.A)(h,[["render",c]]),E=L},347:(e,t,l)=>{l.d(t,{A:()=>c});var i=l(641),n=l(33);const r={class:"sidebar"},o=["href"];function s(e,t,l,s,a,u){return(0,i.uX)(),(0,i.CE)("aside",r,[(0,i.Lk)("nav",null,[(0,i.Lk)("ul",null,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.menuItems,(e=>((0,i.uX)(),(0,i.CE)("li",{key:e.name,class:(0,n.C4)({active:e.active})},[(0,i.Lk)("a",{href:e.link},(0,n.v_)(e.name),9,o)],2)))),128))])])])}const a=(0,i.pM)({name:"SidebarComponent",props:{menuItems:{type:Array,required:!0}}});var u=l(262);const d=(0,u.A)(a,[["render",s],["__scopeId","data-v-8ce43eac"]]),c=d},433:(e,t,l)=>{l.r(t),l.d(t,{default:()=>te});var i=l(641),n=l(33),r=l(751);const o={class:"dashboard"},s={class:"dashboard-container"},a={class:"user-profile"},u={key:0,class:"user-profile"},d=["onClick"],c=["onClick"],k={key:1,class:"user-profile"},m={key:0},h=["onClick"],p=["onClick"],L={key:2,class:"user-profile"},E=["onClick"],g=["onClick"],f={key:3,class:"user-profile"},y={key:0},v=["onClick"],C=["onClick"],b={key:1},M=["onClick"],F=["onClick"],U={key:4,class:"modal-overlay"},D=["disabled"],I={key:0,class:"error-message"},X={key:5,class:"modal-overlay"},A={key:6,class:"modal-overlay",role:"dialog","aria-labelledby":"modal-title"},_={class:"modal-content"},w={id:"modal-title"},P={class:"modal-buttons"},V=["disabled"],S=["disabled"],N={key:0,class:"error-message"},K={key:7,class:"modal-overlay",role:"dialog","aria-labelledby":"modal-title"},Q={class:"modal-content"},O={id:"modal-title"},B={class:"modal-buttons"},R=["disabled"],T=["disabled"],J={key:0,class:"error-message"};function Z(e,t,l,Z,q,x){const $=(0,i.g2)("NavBar");return(0,i.uX)(),(0,i.CE)("div",o,[(0,i.bF)($,{menuItems:e.filteredMenuItems},null,8,["menuItems"]),(0,i.Lk)("main",s,[(0,i.Lk)("section",a,[t[16]||(t[16]=(0,i.Lk)("h2",null,"Profil Utilisateur",-1)),(0,i.Lk)("table",null,[t[15]||(t[15]=(0,i.Lk)("thead",null,[(0,i.Lk)("tr",null,[(0,i.Lk)("th",null,"Nom"),(0,i.Lk)("th",null,"Rôle"),(0,i.Lk)("th",null,"Contract"),(0,i.Lk)("th",null,"Description")])],-1)),(0,i.Lk)("tbody",null,[(0,i.Lk)("tr",null,[(0,i.Lk)("td",null,(0,n.v_)(e.store.userProfile.name),1),(0,i.Lk)("td",null,(0,n.v_)(e.store.userProfile.role),1),(0,i.Lk)("td",null,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.userContract,(e=>((0,i.uX)(),(0,i.CE)("tr",{key:e.id},[(0,i.Lk)("td",null,(0,n.v_)(e.name||"Pas de contrat"),1)])))),128))]),(0,i.Lk)("td",null,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.userContract,(e=>((0,i.uX)(),(0,i.CE)("tr",{key:e.id},[(0,i.Lk)("td",null,(0,n.v_)(e.description||"Pas de description"),1)])))),128))])])])])]),"Manager"!==e.role&&"Utilisateur"!==e.role?((0,i.uX)(),(0,i.CE)("section",u,[t[18]||(t[18]=(0,i.Lk)("h2",null,"Contract",-1)),(0,i.Lk)("table",null,[t[17]||(t[17]=(0,i.Lk)("thead",null,[(0,i.Lk)("tr",null,[(0,i.Lk)("th",null,"Nom"),(0,i.Lk)("th",null,"description"),(0,i.Lk)("th",null,"Actions")])],-1)),(0,i.Lk)("tbody",null,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.contractList,(t=>((0,i.uX)(),(0,i.CE)("tr",{key:t.id},[(0,i.Lk)("td",null,(0,n.v_)(t.name),1),(0,i.Lk)("td",null,(0,n.v_)(t.description),1),(0,i.Lk)("td",null,[(0,i.Lk)("button",{onClick:l=>e.editContract(t.id),class:"edit-button"},"Éditer",8,d),(0,i.Lk)("button",{onClick:l=>e.deleteContract(t.id),class:"delete-button"},"Supprimer",8,c)])])))),128))])])])):(0,i.Q3)("",!0),"Client"!==e.role?((0,i.uX)(),(0,i.CE)("section",k,[t[21]||(t[21]=(0,i.Lk)("h2",null,"Clients",-1)),(0,i.Lk)("table",null,[(0,i.Lk)("thead",null,[(0,i.Lk)("tr",null,[t[19]||(t[19]=(0,i.Lk)("th",null,"Nom",-1)),t[20]||(t[20]=(0,i.Lk)("th",null,"Contrat",-1)),"Manager"!==e.role&&"Utilisateur"!==e.role?((0,i.uX)(),(0,i.CE)("th",m,"Actions")):(0,i.Q3)("",!0)])]),(0,i.Lk)("tbody",null,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.clientList,(t=>((0,i.uX)(),(0,i.CE)("tr",{key:t.id},[(0,i.Lk)("td",null,(0,n.v_)(t.name),1),(0,i.Lk)("td",null,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.contractForManager,(e=>((0,i.uX)(),(0,i.CE)("tr",{key:e.id},[(0,i.Lk)("td",null,(0,n.v_)(e.name||"Pas de contrat"),1)])))),128))]),(0,i.Lk)("td",null,["Manager"!==e.role&&"Utilisateur"!==e.role?((0,i.uX)(),(0,i.CE)("button",{key:0,onClick:l=>e.editEntity(t.id),class:"edit-button"},"Éditer",8,h)):(0,i.Q3)("",!0),"Manager"!==e.role&&"Utilisateur"!==e.role?((0,i.uX)(),(0,i.CE)("button",{key:1,onClick:l=>e.deleteEntity(t.id),class:"delete-button"},"Supprimer",8,p)):(0,i.Q3)("",!0)])])))),128))])])])):(0,i.Q3)("",!0),"Manager"!==e.role?((0,i.uX)(),(0,i.CE)("section",L,[t[23]||(t[23]=(0,i.Lk)("h2",null,"Managers",-1)),(0,i.Lk)("table",null,[t[22]||(t[22]=(0,i.Lk)("thead",null,[(0,i.Lk)("tr",null,[(0,i.Lk)("th",null,"Nom"),(0,i.Lk)("th",null,"Contrat")])],-1)),(0,i.Lk)("tbody",null,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.managerList,(t=>((0,i.uX)(),(0,i.CE)("tr",{key:t.id},[(0,i.Lk)("td",null,(0,n.v_)(t.name),1),(0,i.Lk)("td",null,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(t.contracts,(t=>((0,i.uX)(),(0,i.CE)("tr",{key:t.id},[(0,i.Lk)("td",null,[(0,i.eW)((0,n.v_)(t.name||"Pas de contrat")+" ",1),"Utilisateur"!==e.role?((0,i.uX)(),(0,i.CE)("button",{key:0,onClick:l=>e.editEntity(t.id),class:"edit-button"},"Éditer",8,E)):(0,i.Q3)("",!0),"Utilisateur"!==e.role?((0,i.uX)(),(0,i.CE)("button",{key:1,onClick:l=>e.deleteEntity(t.id),class:"delete-button"},"Supprimer",8,g)):(0,i.Q3)("",!0)])])))),128))])])))),128))])])])):(0,i.Q3)("",!0),"Utilisateur"!==e.role?((0,i.uX)(),(0,i.CE)("section",f,[t[25]||(t[25]=(0,i.Lk)("h2",null,"Utilisateurs",-1)),(0,i.Lk)("table",null,[t[24]||(t[24]=(0,i.Lk)("thead",null,[(0,i.Lk)("tr",null,[(0,i.Lk)("th",null,"Nom"),(0,i.Lk)("th",null,"Manager"),(0,i.Lk)("th",null,"Contrat"),(0,i.Lk)("th",null,"Tache"),(0,i.Lk)("th",null,"Status"),(0,i.Lk)("th",null,"Actions")])],-1)),"Manager"!==e.role?((0,i.uX)(),(0,i.CE)("tbody",y,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.utilisateurList,(t=>((0,i.uX)(),(0,i.CE)("tr",{key:t.id},[(0,i.Lk)("td",null,(0,n.v_)(t.name),1),(0,i.Lk)("td",null,(0,n.v_)(e.store.users.find((e=>e.id===Number(t.managerId)))?e.store.users.find((e=>e.id===Number(t.managerId))).name:"Manager Inconnu"),1),(0,i.Lk)("td",null,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(t.contracts,(e=>((0,i.uX)(),(0,i.CE)("tr",{key:e.id},[(0,i.Lk)("td",null,(0,n.v_)(e.name||"Pas de contrat"),1)])))),128))]),(0,i.Lk)("td",null,(0,n.v_)(t.task||"Pas de tache"),1),(0,i.Lk)("td",null,(0,n.v_)(t.status),1),(0,i.Lk)("td",null,[(0,i.Lk)("button",{onClick:l=>e.editEntity(t.id),class:"edit-button"},"Éditer",8,v),(0,i.Lk)("button",{onClick:l=>e.deleteEntity(t.id),class:"delete-button"},"Supprimer",8,C)])])))),128))])):((0,i.uX)(),(0,i.CE)("tbody",b,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.utilisateurForManager,(t=>((0,i.uX)(),(0,i.CE)("tr",{key:t.id},[(0,i.Lk)("td",null,(0,n.v_)(t.name),1),(0,i.Lk)("td",null,(0,n.v_)(e.nameManager),1),(0,i.Lk)("td",null,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(t.contracts,(e=>((0,i.uX)(),(0,i.CE)("tr",{key:e.id},[(0,i.Lk)("td",null,(0,n.v_)(e.name||"Pas de contrat"),1)])))),128))]),(0,i.Lk)("td",null,(0,n.v_)(t.task||"Pas de tache"),1),(0,i.Lk)("td",null,(0,n.v_)(t.status),1),(0,i.Lk)("td",null,[(0,i.Lk)("button",{onClick:l=>e.editEntity(t.id),class:"edit-button"},"Éditer",8,M),(0,i.Lk)("button",{onClick:l=>e.deleteEntity(t.id),class:"delete-button"},"Supprimer",8,F)])])))),128))]))])])):(0,i.Q3)("",!0),e.isEditModalVisible?((0,i.uX)(),(0,i.CE)("div",U,[(0,i.Lk)("form",{onSubmit:t[3]||(t[3]=(0,r.D$)(((...t)=>e.confirmEdit&&e.confirmEdit(...t)),["prevent"])),class:"modal-content"},[(0,i.Lk)("h3",null,"Modifier "+(0,n.v_)(e.currentEntity?.name),1),(0,i.Lk)("div",null,[t[26]||(t[26]=(0,i.Lk)("label",{for:"name"},"Nom",-1)),(0,i.bo)((0,i.Lk)("input",{type:"text",id:"name","onUpdate:modelValue":t[0]||(t[0]=t=>e.editForm.name=t),required:""},null,512),[[r.Jo,e.editForm.name]])]),(0,i.Lk)("div",null,[t[27]||(t[27]=(0,i.Lk)("label",{for:"description"},"Description",-1)),(0,i.bo)((0,i.Lk)("textarea",{id:"description","onUpdate:modelValue":t[1]||(t[1]=t=>e.editForm.description=t),rows:"4"},null,512),[[r.Jo,e.editForm.description]])]),(0,i.Lk)("button",{type:"submit",disabled:e.isDeleting},(0,n.v_)(e.isDeleting?"Enregistrement en cours...":"Enregistrer"),9,D),(0,i.Lk)("button",{type:"button",onClick:t[2]||(t[2]=(...t)=>e.closeModal&&e.closeModal(...t))},"Annuler"),e.deleteError?((0,i.uX)(),(0,i.CE)("p",I,(0,n.v_)(e.deleteError),1)):(0,i.Q3)("",!0)],32)])):(0,i.Q3)("",!0),e.isEditUserModalVisible?((0,i.uX)(),(0,i.CE)("div",X,[(0,i.Lk)("form",{onSubmit:t[10]||(t[10]=(0,r.D$)(((...t)=>e.confirmUserEdit&&e.confirmUserEdit(...t)),["prevent"])),class:"modal-content"},[(0,i.Lk)("h3",null,"Modifier "+(0,n.v_)(e.currentUser?.name),1),(0,i.Lk)("div",null,[t[28]||(t[28]=(0,i.Lk)("label",{for:"name"},"Nom",-1)),(0,i.bo)((0,i.Lk)("input",{type:"text",id:"name","onUpdate:modelValue":t[4]||(t[4]=t=>e.userEditForm.name=t),required:""},null,512),[[r.Jo,e.userEditForm.name]])]),(0,i.Lk)("div",null,[t[29]||(t[29]=(0,i.Lk)("label",{for:"email"},"Email",-1)),(0,i.bo)((0,i.Lk)("input",{type:"email",id:"email","onUpdate:modelValue":t[5]||(t[5]=t=>e.userEditForm.email=t),required:""},null,512),[[r.Jo,e.userEditForm.email]])]),(0,i.Lk)("div",null,[t[31]||(t[31]=(0,i.Lk)("label",{for:"role"},"Rôle",-1)),(0,i.bo)((0,i.Lk)("select",{id:"role","onUpdate:modelValue":t[6]||(t[6]=t=>e.userEditForm.role=t)},t[30]||(t[30]=[(0,i.Lk)("option",{value:"Client"},"Client",-1),(0,i.Lk)("option",{value:"Manager"},"Manager",-1),(0,i.Lk)("option",{value:"Utilisateur"},"Utilisateur",-1)]),512),[[r.u1,e.userEditForm.role]])]),(0,i.Lk)("div",null,[t[32]||(t[32]=(0,i.Lk)("label",{for:"status"},"tache",-1)),(0,i.bo)((0,i.Lk)("input",{type:"text",id:"task","onUpdate:modelValue":t[7]||(t[7]=t=>e.userEditForm.task=t)},null,512),[[r.Jo,e.userEditForm.task]])]),(0,i.Lk)("div",null,[t[33]||(t[33]=(0,i.Lk)("label",{for:"status"},"Statut",-1)),(0,i.bo)((0,i.Lk)("input",{type:"text",id:"status","onUpdate:modelValue":t[8]||(t[8]=t=>e.userEditForm.status=t)},null,512),[[r.Jo,e.userEditForm.status]])]),t[34]||(t[34]=(0,i.Lk)("button",{type:"submit"},"Enregistrer",-1)),(0,i.Lk)("button",{type:"button",onClick:t[9]||(t[9]=(...t)=>e.closeModal&&e.closeModal(...t))},"Annuler")],32)])):(0,i.Q3)("",!0),e.isDeleteModalVisible?((0,i.uX)(),(0,i.CE)("div",A,[(0,i.Lk)("div",_,[(0,i.Lk)("h3",w,"Supprimer "+(0,n.v_)(e.currentEntity?.name),1),t[35]||(t[35]=(0,i.Lk)("p",null,"Êtes-vous sûr de vouloir supprimer cet élément ?",-1)),(0,i.Lk)("div",P,[(0,i.Lk)("button",{onClick:t[11]||(t[11]=(...t)=>e.confirmDelete&&e.confirmDelete(...t)),disabled:e.isDeleting},"Confirmer",8,V),(0,i.Lk)("button",{onClick:t[12]||(t[12]=(...t)=>e.closeModal&&e.closeModal(...t)),disabled:e.isDeleting},"Annuler",8,S)]),e.deleteError?((0,i.uX)(),(0,i.CE)("p",N,(0,n.v_)(e.deleteError),1)):(0,i.Q3)("",!0)])])):(0,i.Q3)("",!0),e.isDeleteUserModalVisible?((0,i.uX)(),(0,i.CE)("div",K,[(0,i.Lk)("div",Q,[(0,i.Lk)("h3",O,"Supprimer "+(0,n.v_)(e.currentEntity?.name),1),t[36]||(t[36]=(0,i.Lk)("p",null,"Êtes-vous sûr de vouloir supprimer cet Utilisateur ?",-1)),(0,i.Lk)("div",B,[(0,i.Lk)("button",{onClick:t[13]||(t[13]=(...t)=>e.confirmDeleteUser&&e.confirmDeleteUser(...t)),disabled:e.isDeleting},"Confirmer",8,R),(0,i.Lk)("button",{onClick:t[14]||(t[14]=(...t)=>e.closeModal&&e.closeModal(...t)),disabled:e.isDeleting},"Annuler",8,T)]),e.deleteError?((0,i.uX)(),(0,i.CE)("p",J,(0,n.v_)(e.deleteError),1)):(0,i.Q3)("",!0)])])):(0,i.Q3)("",!0)])])}var q=l(953),x=l(220),$=l(866),z=l(523),W=l(347),Y=l(939),j=l(6);const G=(0,i.pM)({name:"Dashboard",mounted(){document.title="Dashboard"},components:{ButtonComponent:z.A,SidebarComponent:W.A,NavBar:Y.A},mutations:{removeContract(e,t){e.listContract=e.listContract.filter((e=>e.id!==t))}},data(){return{filteredMenuItems:[],username:"Invité",role:"User",isEditModalVisible:!1,isEditUserModalVisible:!1,isDeleteUserModalVisible:!1,isDeleteModalVisible:!1,currentEntity:null,deleteError:null,isDeleting:!1,editForm:{name:"",description:""},userEditForm:{name:"",email:"",role:"",task:"",status:""}}},setup(){const e=(0,x.rd)(),t=(0,$.P)(),l=(0,q.KR)([]),n=(0,q.KR)(""),r=t.userProfile?t.userProfile.name:"Default Name",o=localStorage.getItem("role")||"Utilisateur",s=localStorage.getItem("token"),a=localStorage.getItem("id"),u=t.isAuthenticated;let d,c,k,m,h;const p=(0,q.KR)([]);let L;const E=t.userProfile.contracts.map((e=>({id:e.id,name:e.name,description:e.description,userId:e.userId}||[])));if(t.users){if(d=t.users.filter((e=>"Client"===e.role)),c=t.users.filter((e=>"Manager"===e.role)),k=t.users.filter((e=>"Utilisateur"===e.role)),m=k.filter((e=>e.managerId?.includes(a))),m.length>0){const e=c.find((e=>e.id===Number(a)));h=e?e.name:"Manager Inconnu",console.log("Nom du Manager :",h)}else console.log("Aucun utilisateur trouvé pour ce manager.");console.log("Liste des utilisateurs :",k),console.log("Utilisateurs pour le manager spécifié :",m),console.log("Nom du Manager :",h),d.forEach((e=>{if(e.contracts){const t=e.contracts,l=t.filter((e=>E.some((t=>t.id===e.id))));l.length>0?L=l:console.log("\n\n Aucun contrat correspondant trouvé pour ce client.")}}));let e=[],l=[];k.forEach((t=>{t.managerId&&(e=e.concat(t.managerId),l=l.concat(t.id))}))}else console.error("store.users is undefined");console.log("\n\n user actif ",E,"\n\n"),console.log("\n\n client",d,"\n\n"),console.log("\n\n Manager",c,"\n\n"),console.log("\n\n utilisateur",m,"\n\n");const g=(0,q.KR)([{name:"Tableau de Bord",link:"/dashboard",active:!1,visibleTo:["Admin","Client","Manager","Utilisateur"]},{name:"Liste des Utilisateurs",link:"/liste",active:!1,visibleTo:["Admin","Client","Manager"]},{name:"Liste des contract",link:"/contract",active:!0,visibleTo:["Admin","Client"]}]),f=g.value.filter((e=>e.visibleTo.includes(o)));function y(e){const l=t.users.find((t=>t.id===e));this.currentUser=l,this.userEditForm.name=l.name,this.userEditForm.email=l.email,this.userEditForm.role=l.role,this.userEditForm.task=l.task,this.userEditForm.status=l.status||"",this.isEditUserModalVisible=!0}function v(e){const l=t.listContract.find((t=>t.id===e));this.currentEntity=l,this.editForm.name=l.name,this.editForm.description=l.description,this.isEditModalVisible=!0}function C(e){const l=t.users.find((t=>t.id===e));l&&(this.currentEntity=l,this.isDeleteUserModalVisible=!0)}function b(e){const l=t.listContract.find((t=>t.id===e));l&&(this.currentEntity=l,this.isDeleteModalVisible=!0)}function M(){this.isEditModalVisible=!1,this.isDeleteModalVisible=!1,this.isEditUserModalVisible=!1,this.isDeleteUserModalVisible=!1,this.currentEntity=null,this.deleteError=null}async function F(){if(!this.currentEntity||!this.currentEntity.id)return console.error("Aucune entité valide sélectionnée pour la suppression."),void(this.deleteError="Aucune entité valide sélectionnée.");console.log("Updating entity:",this.currentEntity.id,this.editForm),this.isDeleting=!0,this.deleteError=null;try{await(0,j.yp)(this.currentEntity.id,{name:this.editForm.name,description:this.editForm.description}),p.value=await(0,j.PF)(o,s),this.closeModal()}catch(e){console.error("Erreur lors de la suppression :",e),this.deleteError="Échec de la suppression. Veuillez réessayer."}finally{this.isDeleting=!1}}async function U(){if(!this.currentEntity||!this.currentEntity.id)return console.error("Aucune entité valide sélectionnée pour la suppression."),void(this.deleteError="Aucune entité valide sélectionnée.");console.log("Updating user:",this.currentUser.id,this.userEditForm),this.isDeleting=!0,this.deleteError=null;try{await(0,j.CK)(this.currentEntity.id,{name:this.userEditForm.name,email:this.userEditForm.email,role:this.userEditForm.role,task:this.userEditForm.task,status:this.userEditForm.status}),k=t.users.filter((e=>"Utilisateur"===e.role)),this.closeModal()}catch(e){console.error("Erreur lors de la suppression :",e),this.deleteError="Échec de la suppression. Veuillez réessayer."}finally{this.isDeleting=!1}}async function D(){if(!this.currentEntity||!this.currentEntity.id)return console.error("Aucune entité valide sélectionnée pour la suppression."),void(this.deleteError="Aucune entité valide sélectionnée.");console.log("Deleting entity:",this.currentEntity.id),this.isDeleting=!0,this.deleteError=null;try{await(0,j.r9)(this.currentEntity.id),p.value=await(0,j.PF)(o,s),this.closeModal()}catch(e){console.error("Erreur lors de la suppression :",e),this.deleteError="Échec de la suppression. Veuillez réessayer."}finally{this.isDeleting=!1}}async function I(){if(!this.currentEntity||!this.currentEntity.id)return console.error("Aucune entité valide sélectionnée pour la suppression."),void(this.deleteError="Aucune entité valide sélectionnée.");console.log("Deleting entity:",this.currentEntity.id),this.isDeleting=!0,this.deleteError=null;try{await(0,j.hG)(this.currentEntity.id),this.closeModal()}catch(e){console.error("Erreur lors de la suppression :",e),this.deleteError="Échec de la suppression. Veuillez réessayer."}finally{this.isDeleting=!1}}(0,i.sV)((async()=>{if(s){console.log(r,"-",o);const e=await(0,j.ZZ)(o,s);l.value=e,console.log("storage",e),p.value=await(0,j.PF)(o,s)}else console.error("authentication token is missing")}));const X=async()=>{e.push({name:"Login"})};return{username:r,role:o,menuItems:g,filteredMenuItems:f,utilisateurList:k,utilisateurForManager:m,userContract:E,entities:l,entityTitle:n,editEntity:y,closeModal:M,confirmEdit:F,confirmDelete:D,contractForManager:L,contractList:p,deleteEntity:C,isAuthenticated:u,logout:X,clientList:d,managerList:c,store:t,nameManager:h,editContract:v,deleteContract:b,confirmUserEdit:U,confirmDeleteUser:I}}});var H=l(262);const ee=(0,H.A)(G,[["render",Z]]),te=ee},866:(e,t,l)=>{l.d(t,{P:()=>r});var i=l(615),n=l(6);const r=(0,i.nY)({id:"auth",state:()=>({token:localStorage.getItem("token")||null,userProfile:null,users:[],userList:[],listContract:[],listClients:[],listManagers:[],listUtilisateurs:[],isAuthenticated:!!localStorage.getItem("token")}),actions:{async performLogin(e,t){try{const l=await(0,n.iD)(e,t),i=l.token,r=l.role,o=l.id;this.token=i,localStorage.setItem("token",i),localStorage.setItem("role",r),localStorage.setItem("id",o),this.isAuthenticated=!0,await this.fetchUserProfile(i),await this.fetchUsers(r,i),await this.fetchContract(r,i)}catch(l){throw console.error("Authentication failed:",l),new Error("Login failed")}},async fetchUserProfile(e){if(e)try{const t=await(0,n.VM)(e);this.userProfile=t,this.isAuthenticated=!0}catch(t){console.error("Failed to fetch user profile:",t),this.isAuthenticated=!1}else console.error("No token provided")},async fetchUsers(e,t){if(t)try{const l=await(0,n.ZZ)(e,t);console.log("storage",l),this.users=l,console.log(this.users),this.isAuthenticated=!0}catch(l){console.error("Failed to fetch user:",l),this.isAuthenticated=!1}else console.error("No token provided")},async fetchUsersBY(e,t){if(t)try{const l=await(0,n.lo)(e,t);console.log("storage",l),this.userList=l,console.log("liste ",this.userList)}catch(l){console.error("Failed to fetch user:",l),this.isAuthenticated=!1}else console.error("No token provided")},async fetchContract(e,t){if(t)try{const l=await(0,n.PF)(e,t);console.log("storage",l),this.listContract=l,console.log("liste ",this.listContract)}catch(l){console.error("Failed to fetch user:",l),this.isAuthenticated=!1}else console.error("No token provided")},async performLogout(){if(this.token)try{await(0,n.y4)(this.token),this.isAuthenticated=!1,this.userProfile=null,localStorage.removeItem("token"),localStorage.removeItem("role"),localStorage.removeItem("id")}catch(e){console.error("Failed to logout:",e)}else console.error("No token provided")},async addUser(e){},async fetchUsersByRole(e){if(this.token)try{const t=await(0,n.ZZ)(e,this.token);"client"===e?this.listClients=t:"manager"===e?this.listManagers=t:this.listUtilisateurs=t}catch(t){console.error(`Failed to fetch ${e}s:`,t)}else console.error("No token provided")}}})}}]);
//# sourceMappingURL=432.09cdb14c.js.map