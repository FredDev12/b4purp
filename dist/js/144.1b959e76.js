"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[144],{639:(e,t,o)=>{o.d(t,{A:()=>d});var r=o(641);const l={class:"image-upload-container"};function a(e,t,o,a,s,n){return(0,r.uX)(),(0,r.CE)("div",l,[(0,r.Lk)("input",{type:"file",onChange:t[0]||(t[0]=(...t)=>e.handleFileUpload&&e.handleFileUpload(...t)),accept:".png, .jpg, .jpeg, .csv",class:"file-input"},null,32)])}const s=(0,r.pM)({name:"ImageUpload",emits:["update:file"],setup(e,{emit:t}){const o=e=>{const o=e.target,r=o.files,l=r&&r[0];l&&t("update:file",l)};return{handleFileUpload:o}}});var n=o(262);const i=(0,n.A)(s,[["render",a],["__scopeId","data-v-0c012dc8"]]),d=i},189:(e,t,o)=>{o.d(t,{A:()=>m});var r=o(641),l=o(33);const a={class:"input-field"},s=["for"],n=["id","type","value","placeholder","disabled","maxlength","minlength"],i={key:1,class:"error-message"};function d(e,t,o,d,u,c){return(0,r.uX)(),(0,r.CE)("div",a,[e.label?((0,r.uX)(),(0,r.CE)("label",{key:0,for:e.id,class:"input-label"},(0,l.v_)(e.label),9,s)):(0,r.Q3)("",!0),(0,r.Lk)("input",{id:e.id,type:e.type,value:e.modelValue,placeholder:e.placeholder,disabled:e.disabled,maxlength:e.maxlength,minlength:e.minlength,onInput:t[0]||(t[0]=t=>e.$emit("update:modelValue",t.target.value)),class:"input"},null,40,n),e.errorMessage?((0,r.uX)(),(0,r.CE)("p",i,(0,l.v_)(e.errorMessage),1)):(0,r.Q3)("",!0)])}const u=(0,r.pM)({name:"InputField",props:{id:{type:String,required:!0},label:{type:String,required:!0},type:{type:String,default:"text"},modelValue:{type:String,required:!0},placeholder:{type:String,required:!0},disabled:{type:Boolean,required:!1,default:!1},maxlength:{type:Number,required:!1},minlength:{type:Number,required:!1},errorMessage:{type:String,required:!1}}});var c=o(262);const p=(0,c.A)(u,[["render",d],["__scopeId","data-v-493aa504"]]),m=p},939:(e,t,o)=>{o.d(t,{A:()=>v});var r=o(641),l=o(33),a=o(751);const s=o.p+"img/user1.8b23ecd3.png",n={class:"navbar"},i={class:"action-bubble"},d={class:"welcom"},u={key:0,class:"dropdown-menu"};function c(e,t,o,c,p,m){const h=(0,r.g2)("router-link");return(0,r.uX)(),(0,r.CE)("div",null,[(0,r.Lk)("header",n,[t[4]||(t[4]=(0,r.Lk)("div",{class:"logo"},[(0,r.Lk)("a",{href:"/"},"MonLogo")],-1)),(0,r.Lk)("div",{class:(0,l.C4)(["menu",{active:e.isMenuOpen}])},[(0,r.Lk)("ul",null,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(e.menuItems,(e=>((0,r.uX)(),(0,r.CE)("li",{key:e.name,class:(0,l.C4)({active:e.active})},[(0,r.bF)(h,{class:"link",to:e.link},{default:(0,r.k6)((()=>[(0,r.eW)((0,l.v_)(e.name),1)])),_:2},1032,["to"])],2)))),128))])],2),(0,r.Lk)("div",i,[(0,r.Lk)("h1",d,"Bonjour, "+(0,l.v_)(e.username)+" !",1),(0,r.Lk)("button",{onClick:t[0]||(t[0]=(...t)=>e.toggleDropdown&&e.toggleDropdown(...t)),class:"action-button"},t[3]||(t[3]=[(0,r.Lk)("img",{src:s,alt:"Profile",class:"profile-picture"},null,-1)])),e.isDropdownOpen?((0,r.uX)(),(0,r.CE)("div",u,[(0,r.Lk)("ul",null,[(0,r.Lk)("li",null,[(0,r.Lk)("a",{href:"#",onClick:t[1]||(t[1]=(0,a.D$)(((...t)=>e.profil&&e.profil(...t)),["prevent"]))},"Mon profil")]),(0,r.Lk)("li",null,[(0,r.Lk)("a",{href:"#",onClick:t[2]||(t[2]=(0,a.D$)(((...t)=>e.logout&&e.logout(...t)),["prevent"]))},"Se déconnecter")])])])):(0,r.Q3)("",!0)])])])}var p=o(220),m=o(866);const h=(0,r.pM)({name:"NavbarComponent",props:{menuItems:{type:Array,required:!0}},setup(){const e=(0,p.rd)(),t=(0,m.P)(),o=t.userProfile?t.userProfile.name:"Default Name",r=()=>{localStorage.removeItem("token"),localStorage.removeItem("username"),localStorage.removeItem("role"),e.push("/")},l=()=>{e.push({name:"profile"})};return{logout:r,profil:l,username:o}},data(){return{isMenuOpen:!1,isDropdownOpen:!1}},methods:{toggleMenu(){this.isMenuOpen=!this.isMenuOpen},toggleDropdown(){this.isDropdownOpen=!this.isDropdownOpen}}});var g=o(262);const f=(0,g.A)(h,[["render",c]]),v=f},475:(e,t,o)=>{o.d(t,{A:()=>m});var r=o(641),l=o(33),a=o(751);const s={for:"select",class:"select-label"},n=["id"],i=["value"];function d(e,t,o,d,u,c){return(0,r.uX)(),(0,r.CE)("div",null,[(0,r.Lk)("label",s,(0,l.v_)(e.label),1),(0,r.bo)((0,r.Lk)("select",{"onUpdate:modelValue":t[0]||(t[0]=t=>e.selectedOption=t),class:"gender-select",id:e.uniqueId},[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(e.options,(e=>((0,r.uX)(),(0,r.CE)("option",{key:e.value,value:e.value},(0,l.v_)(e.label),9,i)))),128))],8,n),[[a.u1,e.selectedOption]])])}const u=(0,r.pM)({name:"SelectComponent",props:{modelValue:{type:String,required:!1},options:{type:Array,required:!0},label:{type:String,default:"Sélectionnez une option"},id:{type:String,default:""}},emits:["update:modelValue"],setup(e,{emit:t}){const o=(0,r.EW)((()=>e.id||`select-${Math.random().toString(36).substr(2,9)}`)),l=(0,r.EW)({get:()=>e.modelValue,set:e=>t("update:modelValue",e)});return{selectedOption:l,options:e.options,uniqueId:o}}});var c=o(262);const p=(0,c.A)(u,[["render",d],["__scopeId","data-v-e67af60c"]]),m=p},137:(e,t,o)=>{o.r(t),o.d(t,{default:()=>C});var r=o(641),l=o(751),a=o(33);const s={class:"register"},n={class:"form-group"},i={key:0,class:"error"};function d(e,t,o,d,u,c){const p=(0,r.g2)("NavBar"),m=(0,r.g2)("InputField"),h=(0,r.g2)("SelectComponent"),g=(0,r.g2)("ImageUpload"),f=(0,r.g2)("ButtonComponent");return(0,r.uX)(),(0,r.CE)("div",s,[(0,r.bF)(p,{menuItems:e.filteredMenuItems},null,8,["menuItems"]),t[6]||(t[6]=(0,r.Lk)("h1",null,"Inscription",-1)),(0,r.Lk)("form",{onSubmit:t[5]||(t[5]=(0,l.D$)(((...t)=>e.handleRegister&&e.handleRegister(...t)),["prevent"]))},[(0,r.Lk)("div",n,[(0,r.bF)(m,{id:"name",label:"Nom",modelValue:e.form.name,"onUpdate:modelValue":t[0]||(t[0]=t=>e.form.name=t),type:"text",placeholder:"Nom",required:""},null,8,["modelValue"]),(0,r.bF)(m,{id:"email",label:"Email",modelValue:e.form.email,"onUpdate:modelValue":t[1]||(t[1]=t=>e.form.email=t),type:"email",placeholder:"Votre email","error-message":e.emailError,required:""},null,8,["modelValue","error-message"]),(0,r.bF)(m,{id:"password",label:"Mot de passe",modelValue:e.form.password,"onUpdate:modelValue":t[2]||(t[2]=t=>e.form.password=t),type:"password",placeholder:"Votre mot de passe","error-message":e.passwordError,required:""},null,8,["modelValue","error-message"]),(0,r.bF)(m,{id:"password",label:"Confirmez le Mot de passe",modelValue:e.form.confirmPassword,"onUpdate:modelValue":t[3]||(t[3]=t=>e.form.confirmPassword=t),type:"password",placeholder:"Confirmez le mot de passe","error-message":e.passwordError,required:""},null,8,["modelValue","error-message"]),(0,r.bF)(h,{id:"role",modelValue:e.form.role,"onUpdate:modelValue":t[4]||(t[4]=t=>e.form.role=t),options:e.roleOptions,label:"role",required:""},null,8,["modelValue","options"]),(0,r.bF)(g,{"onUpdate:file":e.handleFile,required:""},null,8,["onUpdate:file"])]),(0,r.bF)(f,{type:"submit",class:"btn-primary",disabled:e.loading},{default:(0,r.k6)((()=>[e.loading?((0,r.uX)(),(0,r.CE)(r.FK,{key:0},[(0,r.eW)("Chargement...")],64)):((0,r.uX)(),(0,r.CE)(r.FK,{key:1},[(0,r.eW)("S'inscrire")],64))])),_:1},8,["disabled"]),e.apiError?((0,r.uX)(),(0,r.CE)("p",i,(0,a.v_)(e.apiError),1)):(0,r.Q3)("",!0)],32)])}var u=o(953),c=o(220),p=o(6),m=o(523),h=o(189),g=o(475),f=o(639),v=o(939);const k=(0,r.pM)({name:"Register",components:{ButtonComponent:m.A,InputField:h.A,SelectComponent:g.A,ImageUpload:f.A,NavBar:v.A},data(){return{filteredMenuItems:[],username:"Invité",role:"User"}},setup(){const e=(0,c.rd)(),t=(0,u.KR)(localStorage.getItem("role")||"User"),o=(0,u.Kh)({name:"",email:"",password:"",confirmPassword:"",photo:null|File,role:""}),r=(0,u.KR)([{value:"Manager",label:"Manager"},{value:"Utilisateur",label:"Utilisateur"}]),l=e=>{o.photo=e},a=(0,u.KR)(""),s=(0,u.KR)(""),n=(0,u.KR)(""),i=(0,u.KR)(!1),d=(0,u.KR)([{name:"Tableau de Bord",link:"/dashboard",active:!1,visibleTo:["Admin","Client","Manager","Utilisateur"]},{name:"Liste des Utilisateurs",link:"/liste",active:!1,visibleTo:["Admin","Client","Manager"]},{name:"Liste des contract",link:"/contract",active:!0,visibleTo:["Admin","Client"]}]),m=d.value.filter((e=>e.visibleTo.includes(t.value))),h=async()=>{if(console.log(o.photo),i.value=!0,a.value="",s.value="",n.value="",!g(o.email))return a.value="Veuillez entrer une adresse email valide.",void(i.value=!1);if(o.password.length<6)return s.value="Le mot de passe doit contenir au moins 6 caractères.",void(i.value=!1);if(o.password!==o.confirmPassword)return s.value="Le mot de passe different",void(i.value=!1);try{console.log(o),await(0,p.kz)(o),e.push("/dashboard")}catch(t){n.value="Une erreur est survenue lors de l'inscription. Veuillez réessayer."}finally{i.value=!1}},g=e=>{const t=/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;return t.test(e.trim())};return{handleRegister:h,form:o,filteredMenuItems:m,emailError:a,handleFile:l,role:t,passwordError:s,apiError:n,loading:i,roleOptions:r}}});var b=o(262);const y=(0,b.A)(k,[["render",d]]),C=y},866:(e,t,o)=>{o.d(t,{P:()=>a});var r=o(615),l=o(6);const a=(0,r.nY)({id:"auth",state:()=>({token:localStorage.getItem("token")||null,userProfile:null,users:[],userList:[],listContract:[],listClients:[],listManagers:[],listUtilisateurs:[],isAuthenticated:!!localStorage.getItem("token")}),actions:{async performLogin(e,t){try{const o=await(0,l.iD)(e,t),r=o.token,a=o.role,s=o.id;this.token=r,localStorage.setItem("token",r),localStorage.setItem("role",a),localStorage.setItem("id",s),this.isAuthenticated=!0,await this.fetchUserProfile(r),await this.fetchUsers(a,r),await this.fetchContract(a,r)}catch(o){throw console.error("Authentication failed:",o),new Error("Login failed")}},async fetchUserProfile(e){if(e)try{const t=await(0,l.VM)(e);this.userProfile=t,this.isAuthenticated=!0}catch(t){console.error("Failed to fetch user profile:",t),this.isAuthenticated=!1}else console.error("No token provided")},async fetchUsers(e,t){if(t)try{const o=await(0,l.ZZ)(e,t);console.log("storage",o),this.users=o,console.log(this.users),this.isAuthenticated=!0}catch(o){console.error("Failed to fetch user:",o),this.isAuthenticated=!1}else console.error("No token provided")},async fetchUsersBY(e,t){if(t)try{const o=await(0,l.lo)(e,t);console.log("storage",o),this.userList=o,console.log("liste ",this.userList)}catch(o){console.error("Failed to fetch user:",o),this.isAuthenticated=!1}else console.error("No token provided")},async fetchContract(e,t){if(t)try{const o=await(0,l.PF)(e,t);console.log("storage",o),this.listContract=o,console.log("liste ",this.listContract)}catch(o){console.error("Failed to fetch user:",o),this.isAuthenticated=!1}else console.error("No token provided")},async performLogout(){if(this.token)try{await(0,l.y4)(this.token),this.isAuthenticated=!1,this.userProfile=null,localStorage.removeItem("token"),localStorage.removeItem("role"),localStorage.removeItem("id")}catch(e){console.error("Failed to logout:",e)}else console.error("No token provided")},async addUser(e){},async fetchUsersByRole(e){if(this.token)try{const t=await(0,l.ZZ)(e,this.token);"client"===e?this.listClients=t:"manager"===e?this.listManagers=t:this.listUtilisateurs=t}catch(t){console.error(`Failed to fetch ${e}s:`,t)}else console.error("No token provided")}}})}}]);
//# sourceMappingURL=144.1b959e76.js.map