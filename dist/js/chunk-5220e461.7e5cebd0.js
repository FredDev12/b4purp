(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5220e461"],{"0da1":function(e,t,o){"use strict";o("7233")},"14f4":function(e,t,o){},3724:function(e,t,o){"use strict";var n=o("7a23");const l={for:"select",class:"select-label"},c=["id"],r=["value"];function a(e,t,o,a,i,s){return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",null,[Object(n["createElementVNode"])("label",l,Object(n["toDisplayString"])(e.label),1),Object(n["withDirectives"])(Object(n["createElementVNode"])("select",{"onUpdate:modelValue":t[0]||(t[0]=t=>e.selectedOption=t),class:"gender-select",id:e.uniqueId},[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(e.options,e=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("option",{key:e.value,value:e.value},Object(n["toDisplayString"])(e.label),9,r))),128))],8,c),[[n["vModelSelect"],e.selectedOption]])])}var i=Object(n["defineComponent"])({name:"SelectComponent",props:{modelValue:{type:String,required:!1},options:{type:Array,required:!0},label:{type:String,default:"Sélectionnez une option"},id:{type:String,default:""}},emits:["update:modelValue"],setup(e,{emit:t}){const o=Object(n["computed"])(()=>e.id||"select-"+Math.random().toString(36).substr(2,9)),l=Object(n["computed"])({get:()=>e.modelValue,set:e=>t("update:modelValue",e)});return{selectedOption:l,options:e.options,uniqueId:o}}}),s=(o("0da1"),o("6b0d")),d=o.n(s);const u=d()(i,[["render",a],["__scopeId","data-v-657b3cd4"]]);t["a"]=u},"5d04":function(e,t,o){"use strict";o.d(t,"a",(function(){return c}));var n=o("be92"),l=o("3a50");const c=Object(n["b"])({id:"auth",state:()=>({token:localStorage.getItem("token")||null,userProfile:null,users:[],userList:[],listClients:[],listManagers:[],listUtilisateurs:[],isAuthenticated:!!localStorage.getItem("token")}),actions:{async performLogin(e,t){try{const o=await Object(l["d"])(e,t),n=o.token,c=o.role;this.token=n,localStorage.setItem("token",n),localStorage.setItem("role",c),this.isAuthenticated=!0,await this.fetchUserProfile(n),await this.fetchUsers(c,n)}catch(o){throw console.error("Authentication failed:",o),new Error("Login failed")}},async fetchUserProfile(e){if(e)try{const t=await Object(l["a"])(e);this.userProfile=t,this.isAuthenticated=!0}catch(t){console.error("Failed to fetch user profile:",t),this.isAuthenticated=!1}else console.error("No token provided")},async fetchUsers(e,t){if(t)try{const o=await Object(l["c"])(e,t);console.log("storage",o),this.users=o,console.log(this.users)}catch(o){console.error("Failed to fetch user:",o),this.isAuthenticated=!1}else console.error("No token provided")},async fetchUsersBY(e,t){if(t)try{const o=await Object(l["b"])(e,t);console.log("storage",o),this.userList=o,console.log("liste ",this.userList)}catch(o){console.error("Failed to fetch user:",o),this.isAuthenticated=!1}else console.error("No token provided")},async performLogout(){if(this.token)try{await Object(l["e"])(this.token),this.isAuthenticated=!1,this.userProfile=null,localStorage.removeItem("token"),localStorage.removeItem("role")}catch(e){console.error("Failed to logout:",e)}else console.error("No token provided")},async addUser(e){},async fetchUsersByRole(e){if(this.token)try{const t=await Object(l["c"])(e,this.token);"client"===e?this.listClients=t:"manager"===e?this.listManagers=t:this.listUtilisateurs=t}catch(t){console.error(`Failed to fetch ${e}s:`,t)}else console.error("No token provided")}}})},7233:function(e,t,o){},8192:function(e,t,o){"use strict";var n=o("7a23");const l={class:"input-field"},c=["for"],r=["id","type","value","placeholder","disabled","maxlength","minlength"],a={key:1,class:"error-message"};function i(e,t,o,i,s,d){return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",l,[e.label?(Object(n["openBlock"])(),Object(n["createElementBlock"])("label",{key:0,for:e.id,class:"input-label"},Object(n["toDisplayString"])(e.label),9,c)):Object(n["createCommentVNode"])("",!0),Object(n["createElementVNode"])("input",{id:e.id,type:e.type,value:e.modelValue,placeholder:e.placeholder,disabled:e.disabled,maxlength:e.maxlength,minlength:e.minlength,onInput:t[0]||(t[0]=t=>e.$emit("update:modelValue",t.target.value)),class:"input"},null,40,r),e.errorMessage?(Object(n["openBlock"])(),Object(n["createElementBlock"])("p",a,Object(n["toDisplayString"])(e.errorMessage),1)):Object(n["createCommentVNode"])("",!0)])}var s=Object(n["defineComponent"])({name:"InputField",props:{id:{type:String,required:!0},label:{type:String,required:!0},type:{type:String,default:"text"},modelValue:{type:String,required:!0},placeholder:{type:String,required:!0},disabled:{type:Boolean,required:!1,default:!1},maxlength:{type:Number,required:!1},minlength:{type:Number,required:!1},errorMessage:{type:String,required:!1}}}),d=(o("be8d"),o("6b0d")),u=o.n(d);const m=u()(s,[["render",i],["__scopeId","data-v-424e3b7f"]]);t["a"]=m},"8b2b":function(e,t,o){"use strict";o("14f4")},"8c07":function(e,t,o){"use strict";var n=o("7a23");const l={class:"sidebar"},c=["href"];function r(e,t,o,r,a,i){return Object(n["openBlock"])(),Object(n["createElementBlock"])("aside",l,[Object(n["createElementVNode"])("nav",null,[Object(n["createElementVNode"])("ul",null,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(e.menuItems,e=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("li",{key:e.name,class:Object(n["normalizeClass"])({active:e.active})},[Object(n["createElementVNode"])("a",{href:e.link},Object(n["toDisplayString"])(e.name),9,c)],2))),128))])])])}var a=Object(n["defineComponent"])({name:"SidebarComponent",props:{menuItems:{type:Array,required:!0}}}),i=(o("9261"),o("6b0d")),s=o.n(i);const d=s()(a,[["render",r],["__scopeId","data-v-74b7da77"]]);t["a"]=d},9261:function(e,t,o){"use strict";o("d558")},9529:function(e,t,o){"use strict";var n=o("7a23");const l={class:"image-upload-container"};function c(e,t,o,c,r,a){return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",l,[Object(n["createElementVNode"])("input",{type:"file",onChange:t[0]||(t[0]=(...t)=>e.handleFileUpload&&e.handleFileUpload(...t)),accept:".png, .jpg, .jpeg, .csv",class:"file-input"},null,32)])}var r=Object(n["defineComponent"])({name:"ImageUpload",emits:["update:file"],setup(e,{emit:t}){const o=e=>{const o=e.target,n=o.files,l=n&&n[0];l&&t("update:file",l)};return{handleFileUpload:o}}}),a=(o("8b2b"),o("6b0d")),i=o.n(a);const s=i()(r,[["render",c],["__scopeId","data-v-923aba26"]]);t["a"]=s},b3b1:function(e,t,o){"use strict";o.r(t);var n=o("7a23"),l=o("c121"),c=o.n(l);const r={key:0,class:"profile-container"},a={key:0,src:c.a,alt:"Profile Image",class:"profile-image"},i={key:1,class:"error"},s={key:1,class:"profile"};function d(e,t,o,l,c,d){const u=Object(n["resolveComponent"])("NavBar"),m=Object(n["resolveComponent"])("ButtonComponent");return Object(n["openBlock"])(),Object(n["createElementBlock"])(n["Fragment"],null,[Object(n["createVNode"])(u,{menuItems:e.filteredMenuItems},null,8,["menuItems"]),e.isAuthenticated?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",r,[Object(n["createElementVNode"])("main",null,[e.imageUrl||e.defaultImage?(Object(n["openBlock"])(),Object(n["createElementBlock"])("img",a)):Object(n["createCommentVNode"])("",!0),Object(n["createElementVNode"])("button",{class:"btn",onChange:t[0]||(t[0]=(...t)=>e.changePicture&&e.changePicture(...t))},"changer la photo",32),t[4]||(t[4]=Object(n["createElementVNode"])("h1",null,"Profil de l'utilisateur",-1)),Object(n["createElementVNode"])("p",null,[t[1]||(t[1]=Object(n["createElementVNode"])("strong",null,"Nom :",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.form.name),1)]),Object(n["createElementVNode"])("p",null,[t[2]||(t[2]=Object(n["createElementVNode"])("strong",null,"Email :",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.form.email),1)]),Object(n["createElementVNode"])("p",null,[t[3]||(t[3]=Object(n["createElementVNode"])("strong",null,"Role :",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.form.role),1)]),Object(n["createVNode"])(m,{type:"submit",class:"btn-primary",disabled:e.loading},{default:Object(n["withCtx"])(()=>[e.loading?(Object(n["openBlock"])(),Object(n["createElementBlock"])(n["Fragment"],{key:0},[Object(n["createTextVNode"])("Chargement...")],64)):(Object(n["openBlock"])(),Object(n["createElementBlock"])(n["Fragment"],{key:1},[Object(n["createTextVNode"])("Update")],64))]),_:1},8,["disabled"]),e.apiError?(Object(n["openBlock"])(),Object(n["createElementBlock"])("p",i,Object(n["toDisplayString"])(e.apiError),1)):Object(n["createCommentVNode"])("",!0)])])):(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",s,t[5]||(t[5]=[Object(n["createElementVNode"])("p",null,"Veuillez vous connecter pour modifier votre profil.",-1)])))],64)}var u=o("8c07"),m=o("e4c3"),p=o("d000"),b=o("8192"),O=o("3724"),j=o("9529"),f=o("6605"),g=o("5d04"),h=o("3a50"),k=Object(n["defineComponent"])({name:"Profile",components:{SidebarComponent:u["a"],ButtonComponent:m["a"],InputField:b["a"],SelectComponent:O["a"],ImageUpload:j["a"],NavBar:p["a"]},props:{entityType:{type:String,required:!0}},setup(e){const t=Object(g["a"])(),o=localStorage.getItem("role")||"Utilisateur",l=localStorage.getItem("token"),c=Object(n["ref"])([]),r=Object(n["ref"])([]),a=(Object(f["c"])(),Object(n["reactive"])({name:t.userProfile.name,email:t.userProfile.email,password:"",confirmPassword:"",file:null,role:o})),i=t.isAuthenticated,s=Object(n["ref"])(""),d=Object(n["ref"])("../assets/user.png"),u=null,m=Object(n["ref"])("../assets/user.png"),p=e=>{a.file=e},b=Object(n["ref"])(""),O=Object(n["ref"])(""),j=Object(n["ref"])(""),k=Object(n["ref"])(!1);async function v(e){const t=e.target.files[0],o=new FormData;o.append("photo",t);try{Object(h["f"])(o)}catch(n){console.error("Error uploading file:",n)}}function y(){console.log("Form submitted")}Object(n["onMounted"])(async()=>{if(l){const e=await Object(h["a"])(l);c.value=e,console.log(c.value)}else console.error("Authentication token is missing")});const E=()=>{if(t.token)try{alert("Profile updated successfully!")}catch(e){console.error("Failed to update profile:",e),alert("Failed to update profile.")}else console.error("Authentication token is missing")},N=()=>{console.log("Change profile picture")},V=Object(n["ref"])([{name:"Tableau de Bord",link:"/dashboard",active:!1,visibleTo:["Admin","Client","Manager","Utilisateur"]},{name:"Liste des Utilisateurs",link:"/liste",active:!1,visibleTo:["Admin","Client","Manager"]},{name:"Mon Profil",link:"/profile",active:!0,visibleTo:["Admin","Client","Manager","Utilisateur"]}]),B=V.value.filter(e=>e.visibleTo.includes(o));return{role:o,changePicture:N,isAuthenticated:i,menuItems:V,users:r,form:a,updateProfile:E,emailError:b,handleFile:p,passwordError:O,apiError:j,loading:k,previewImage:u,defaultImage:m,filteredMenuItems:B,handleFileUpload:v,imageUrl:s,submitForm:y,defaultImageUrl:d}}}),v=o("6b0d"),y=o.n(v);const E=y()(k,[["render",d]]);t["default"]=E},be8d:function(e,t,o){"use strict";o("d2e2")},c121:function(e,t,o){e.exports=o.p+"img/user.399c5f70.png"},d000:function(e,t,o){"use strict";var n=o("7a23"),l=o("fd5a"),c=o.n(l);const r={class:"navbar"},a={class:"action-bubble"},i={key:0,class:"dropdown-menu"};function s(e,t,o,l,s,d){const u=Object(n["resolveComponent"])("router-link");return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",null,[Object(n["createElementVNode"])("header",r,[t[4]||(t[4]=Object(n["createElementVNode"])("div",{class:"logo"},[Object(n["createElementVNode"])("a",{href:"/"},"MonLogo")],-1)),Object(n["createElementVNode"])("div",{class:Object(n["normalizeClass"])(["menu",{active:e.isMenuOpen}])},[Object(n["createElementVNode"])("ul",null,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(e.menuItems,e=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("li",{key:e.name,class:Object(n["normalizeClass"])({active:e.active})},[Object(n["createVNode"])(u,{class:"link",to:e.link},{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])(Object(n["toDisplayString"])(e.name),1)]),_:2},1032,["to"])],2))),128))])],2),Object(n["createElementVNode"])("div",a,[Object(n["createElementVNode"])("button",{onClick:t[0]||(t[0]=(...t)=>e.toggleDropdown&&e.toggleDropdown(...t)),class:"action-button"},t[3]||(t[3]=[Object(n["createElementVNode"])("img",{src:c.a,alt:"Profile",class:"profile-picture"},null,-1)])),e.isDropdownOpen?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",i,[Object(n["createElementVNode"])("ul",null,[Object(n["createElementVNode"])("li",null,[Object(n["createElementVNode"])("a",{href:"#",onClick:t[1]||(t[1]=Object(n["withModifiers"])((...t)=>e.profil&&e.profil(...t),["prevent"]))},"Mon profil")]),Object(n["createElementVNode"])("li",null,[Object(n["createElementVNode"])("a",{href:"#",onClick:t[2]||(t[2]=Object(n["withModifiers"])((...t)=>e.logout&&e.logout(...t),["prevent"]))},"Se déconnecter")])])])):Object(n["createCommentVNode"])("",!0)])])])}var d=o("6605"),u=Object(n["defineComponent"])({name:"NavbarComponent",props:{menuItems:{type:Array,required:!0}},setup(){const e=Object(d["c"])(),t=()=>{localStorage.removeItem("token"),localStorage.removeItem("username"),localStorage.removeItem("role"),e.push("/")},o=()=>{e.push({name:"profile"})};return{logout:t,profil:o}},data(){return{isMenuOpen:!1,isDropdownOpen:!1}},methods:{toggleMenu(){this.isMenuOpen=!this.isMenuOpen},toggleDropdown(){this.isDropdownOpen=!this.isDropdownOpen}}}),m=o("6b0d"),p=o.n(m);const b=p()(u,[["render",s]]);t["a"]=b},d2e2:function(e,t,o){},d558:function(e,t,o){},fd5a:function(e,t,o){e.exports=o.p+"img/user1.399c5f70.png"}}]);
//# sourceMappingURL=chunk-5220e461.7e5cebd0.js.map