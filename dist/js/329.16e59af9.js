"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[329],{639:(e,t,a)=>{a.d(t,{A:()=>u});var o=a(641);const l={class:"image-upload-container"};function r(e,t,a,r,n,s){return(0,o.uX)(),(0,o.CE)("div",l,[(0,o.Lk)("input",{type:"file",onChange:t[0]||(t[0]=(...t)=>e.handleFileUpload&&e.handleFileUpload(...t)),accept:".png, .jpg, .jpeg, .csv",class:"file-input"},null,32)])}const n=(0,o.pM)({name:"ImageUpload",emits:["update:file"],setup(e,{emit:t}){const a=e=>{const a=e.target,o=a.files,l=o&&o[0];l&&t("update:file",l)};return{handleFileUpload:a}}});var s=a(262);const i=(0,s.A)(n,[["render",r],["__scopeId","data-v-0c012dc8"]]),u=i},189:(e,t,a)=>{a.d(t,{A:()=>m});var o=a(641),l=a(33);const r={class:"input-field"},n=["for"],s=["id","type","value","placeholder","disabled","maxlength","minlength"],i={key:1,class:"error-message"};function u(e,t,a,u,d,c){return(0,o.uX)(),(0,o.CE)("div",r,[e.label?((0,o.uX)(),(0,o.CE)("label",{key:0,for:e.id,class:"input-label"},(0,l.v_)(e.label),9,n)):(0,o.Q3)("",!0),(0,o.Lk)("input",{id:e.id,type:e.type,value:e.modelValue,placeholder:e.placeholder,disabled:e.disabled,maxlength:e.maxlength,minlength:e.minlength,onInput:t[0]||(t[0]=t=>e.$emit("update:modelValue",t.target.value)),class:"input"},null,40,s),e.errorMessage?((0,o.uX)(),(0,o.CE)("p",i,(0,l.v_)(e.errorMessage),1)):(0,o.Q3)("",!0)])}const d=(0,o.pM)({name:"InputField",props:{id:{type:String,required:!0},label:{type:String,required:!0},type:{type:String,default:"text"},modelValue:{type:String,required:!0},placeholder:{type:String,required:!0},disabled:{type:Boolean,required:!1,default:!1},maxlength:{type:Number,required:!1},minlength:{type:Number,required:!1},errorMessage:{type:String,required:!1}}});var c=a(262);const p=(0,c.A)(d,[["render",u],["__scopeId","data-v-493aa504"]]),m=p},939:(e,t,a)=>{a.d(t,{A:()=>v});var o=a(641),l=a(33),r=a(751);const n=a.p+"img/user1.8b23ecd3.png",s={class:"navbar"},i={class:"action-bubble"},u={class:"welcom"},d={key:0,class:"dropdown-menu"};function c(e,t,a,c,p,m){const g=(0,o.g2)("router-link");return(0,o.uX)(),(0,o.CE)("div",null,[(0,o.Lk)("header",s,[t[4]||(t[4]=(0,o.Lk)("div",{class:"logo"},[(0,o.Lk)("a",{href:"/"},"MonLogo")],-1)),(0,o.Lk)("div",{class:(0,l.C4)(["menu",{active:e.isMenuOpen}])},[(0,o.Lk)("ul",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.menuItems,(e=>((0,o.uX)(),(0,o.CE)("li",{key:e.name,class:(0,l.C4)({active:e.active})},[(0,o.bF)(g,{class:"link",to:e.link},{default:(0,o.k6)((()=>[(0,o.eW)((0,l.v_)(e.name),1)])),_:2},1032,["to"])],2)))),128))])],2),(0,o.Lk)("div",i,[(0,o.Lk)("h1",u,"Bonjour, "+(0,l.v_)(e.username)+" !",1),(0,o.Lk)("button",{onClick:t[0]||(t[0]=(...t)=>e.toggleDropdown&&e.toggleDropdown(...t)),class:"action-button"},t[3]||(t[3]=[(0,o.Lk)("img",{src:n,alt:"Profile",class:"profile-picture"},null,-1)])),e.isDropdownOpen?((0,o.uX)(),(0,o.CE)("div",d,[(0,o.Lk)("ul",null,[(0,o.Lk)("li",null,[(0,o.Lk)("a",{href:"#",onClick:t[1]||(t[1]=(0,r.D$)(((...t)=>e.profil&&e.profil(...t)),["prevent"]))},"Mon profil")]),(0,o.Lk)("li",null,[(0,o.Lk)("a",{href:"#",onClick:t[2]||(t[2]=(0,r.D$)(((...t)=>e.logout&&e.logout(...t)),["prevent"]))},"Se déconnecter")])])])):(0,o.Q3)("",!0)])])])}var p=a(220),m=a(866);const g=(0,o.pM)({name:"NavbarComponent",props:{menuItems:{type:Array,required:!0}},setup(){const e=(0,p.rd)(),t=(0,m.P)(),a=t.userProfile?t.userProfile.name:"Default Name",o=()=>{localStorage.removeItem("token"),localStorage.removeItem("username"),localStorage.removeItem("role"),e.push("/")},l=()=>{e.push({name:"profile"})};return{logout:o,profil:l,username:a}},data(){return{isMenuOpen:!1,isDropdownOpen:!1}},methods:{toggleMenu(){this.isMenuOpen=!this.isMenuOpen},toggleDropdown(){this.isDropdownOpen=!this.isDropdownOpen}}});var h=a(262);const f=(0,h.A)(g,[["render",c]]),v=f},475:(e,t,a)=>{a.d(t,{A:()=>m});var o=a(641),l=a(33),r=a(751);const n={for:"select",class:"select-label"},s=["id"],i=["value"];function u(e,t,a,u,d,c){return(0,o.uX)(),(0,o.CE)("div",null,[(0,o.Lk)("label",n,(0,l.v_)(e.label),1),(0,o.bo)((0,o.Lk)("select",{"onUpdate:modelValue":t[0]||(t[0]=t=>e.selectedOption=t),class:"gender-select",id:e.uniqueId},[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.options,(e=>((0,o.uX)(),(0,o.CE)("option",{key:e.value,value:e.value},(0,l.v_)(e.label),9,i)))),128))],8,s),[[r.u1,e.selectedOption]])])}const d=(0,o.pM)({name:"SelectComponent",props:{modelValue:{type:String,required:!1},options:{type:Array,required:!0},label:{type:String,default:"Sélectionnez une option"},id:{type:String,default:""}},emits:["update:modelValue"],setup(e,{emit:t}){const a=(0,o.EW)((()=>e.id||`select-${Math.random().toString(36).substr(2,9)}`)),l=(0,o.EW)({get:()=>e.modelValue,set:e=>t("update:modelValue",e)});return{selectedOption:l,options:e.options,uniqueId:a}}});var c=a(262);const p=(0,c.A)(d,[["render",u],["__scopeId","data-v-e67af60c"]]),m=p},392:(e,t,a)=>{a.r(t),a.d(t,{default:()=>L});var o=a(641),l=a(751),r=a(33);const n={class:"register"},s={class:"form-group"},i={key:0},u={key:1},d={key:0,class:"error"};function c(e,t,a,c,p,m){const g=(0,o.g2)("NavBar"),h=(0,o.g2)("InputField"),f=(0,o.g2)("SelectComponent"),v=(0,o.g2)("ButtonComponent");return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.bF)(g,{menuItems:e.filteredMenuItems},null,8,["menuItems"]),(0,o.Lk)("div",n,[t[17]||(t[17]=(0,o.Lk)("h1",null,"Ajouter un utilisateur",-1)),(0,o.Lk)("form",{onSubmit:t[13]||(t[13]=(0,l.D$)(((...t)=>e.handleRegister&&e.handleRegister(...t)),["prevent"]))},[(0,o.Lk)("div",s,[t[16]||(t[16]=(0,o.Lk)("label",null,"Type d'utilisateur:",-1)),"Client"===e.role?((0,o.uX)(),(0,o.CE)("div",i,[(0,o.bo)((0,o.Lk)("input",{type:"radio",id:"user",value:"Utilisateur","onUpdate:modelValue":t[0]||(t[0]=t=>e.userType=t),onChange:t[1]||(t[1]=t=>e.updateUserType("Utilisateur"))},null,544),[[l.XL,e.userType]]),t[14]||(t[14]=(0,o.Lk)("label",{for:"user"},"Utilisateur",-1)),(0,o.bo)((0,o.Lk)("input",{type:"radio",id:"manager",value:"Manager","onUpdate:modelValue":t[2]||(t[2]=t=>e.userType=t),onChange:t[3]||(t[3]=t=>e.updateUserType("Manager"))},null,544),[[l.XL,e.userType]]),t[15]||(t[15]=(0,o.Lk)("label",{for:"manager"},"Manager",-1))])):((0,o.uX)(),(0,o.CE)("div",u,[(0,o.Lk)("p",null,(0,r.v_)(e.userType),1)])),(0,o.bF)(h,{id:"name",label:"Nom",modelValue:e.formdata.name,"onUpdate:modelValue":t[4]||(t[4]=t=>e.formdata.name=t),type:"text",placeholder:"Nom",required:""},null,8,["modelValue"]),(0,o.bF)(h,{id:"email",label:"Email",modelValue:e.formdata.email,"onUpdate:modelValue":t[5]||(t[5]=t=>e.formdata.email=t),type:"email",placeholder:"Votre email","error-message":e.emailError,required:""},null,8,["modelValue","error-message"]),(0,o.bF)(h,{id:"password",label:"Mot de passe",modelValue:e.formdata.password,"onUpdate:modelValue":t[6]||(t[6]=t=>e.formdata.password=t),type:"password",placeholder:"Votre mot de passe","error-message":e.passwordError,required:""},null,8,["modelValue","error-message"]),(0,o.bF)(h,{id:"confirmpassword",label:"Confirmez le Mot de passe",modelValue:e.formdata.confirmPassword,"onUpdate:modelValue":t[7]||(t[7]=t=>e.formdata.confirmPassword=t),type:"password",placeholder:"Confirmez le mot de passe","error-message":e.passwordError,required:""},null,8,["modelValue","error-message"]),"Utilisateur"===e.userType?((0,o.uX)(),(0,o.Wv)(f,{key:2,label:"Sélectionnez un Manager",modelValue:e.formdata.managerId,"onUpdate:modelValue":t[8]||(t[8]=t=>e.formdata.managerId=t),options:e.managerOptions,placeholder:"Sélectionnez un Manager"},null,8,["modelValue","options"])):(0,o.Q3)("",!0),"Manager"===e.userType?((0,o.uX)(),(0,o.Wv)(f,{key:3,label:"Sélectionnez un Client",modelValue:e.formdata.clientId,"onUpdate:modelValue":t[9]||(t[9]=t=>e.formdata.clientId=t),options:e.clientOptions,placeholder:"Sélectionnez un Client"},null,8,["modelValue","options"])):(0,o.Q3)("",!0),"Utilisateur"===e.userType?((0,o.uX)(),(0,o.Wv)(h,{key:4,id:"task",label:"tache",modelValue:e.formdata.task,"onUpdate:modelValue":t[10]||(t[10]=t=>e.formdata.task=t),type:"text",placeholder:"Confirmez le mot de passe",options:e.managerOptions,"error-message":e.passwordError,required:""},null,8,["modelValue","options","error-message"])):(0,o.Q3)("",!0),"Utilisateur"===e.userType?((0,o.uX)(),(0,o.Wv)(h,{key:5,id:"etat",label:"status",modelValue:e.formdata.etat,"onUpdate:modelValue":t[11]||(t[11]=t=>e.formdata.etat=t),type:"text",placeholder:"Confirmez le mot de passe",options:e.managerOptions,"error-message":e.passwordError,required:""},null,8,["modelValue","options","error-message"])):(0,o.Q3)("",!0),(0,o.Lk)("input",{type:"file",onChange:t[12]||(t[12]=(...t)=>e.onFileChange&&e.onFileChange(...t))},null,32)]),(0,o.bF)(v,{type:"submit",class:"btn-primary",disabled:e.loading},{default:(0,o.k6)((()=>[e.loading?((0,o.uX)(),(0,o.CE)(o.FK,{key:0},[(0,o.eW)("Chargement...")],64)):((0,o.uX)(),(0,o.CE)(o.FK,{key:1},[(0,o.eW)("Ajouter")],64))])),_:1},8,["disabled"]),e.apiError?((0,o.uX)(),(0,o.CE)("p",d,(0,r.v_)(e.apiError),1)):(0,o.Q3)("",!0)],32)])],64)}var p=a(953),m=a(220),g=a(6),h=a(523),f=a(189),v=a(475),y=a(639),k=a(939),b=a(866);const C=(0,o.pM)({name:"Register",components:{ButtonComponent:h.A,InputField:f.A,SelectComponent:v.A,ImageUpload:y.A,NavBar:k.A},setup(){const e=(0,m.rd)(),t=(0,b.P)(),a=(0,p.KR)(localStorage.getItem("role")||"Utilisateur"),l=(0,p.KR)(localStorage.getItem("token")),r=(0,p.KR)("Utilisateur"),n=(0,p.Kh)({name:"",email:"",password:"",confirmPassword:"",photo:null|File,role:"",managerId:"",clientId:"",utilisateurId:"",task:"",etat:""}),s=(0,p.KR)([]),i=(0,p.KR)([]);function u(e){const t=e.target;t.files&&(n.photo=t.files[0])}const d=(0,p.KR)(""),c=(0,p.KR)(""),h=(0,p.KR)(""),f=(0,p.KR)(!1),v=(0,p.KR)([{name:"Tableau de Bord",link:"/dashboard",active:!1,visibleTo:["Admin","Client","Manager","Utilisateur"]},{name:"Liste des Utilisateurs",link:"/liste",active:!1,visibleTo:["Admin","Client","Manager"]},{name:"Liste des contract",link:"/contract",active:!0,visibleTo:["Admin","Client"]}]),y=(0,o.EW)((()=>v.value.filter((e=>e.visibleTo.includes(a.value)))));async function k(){try{const e=await t.users;return e&&Array.isArray(e)?e.filter((e=>"Manager"===e.role)).map((e=>({value:e.id.toString(),label:e.name}))):[]}catch(e){return console.error("Failed to fetch managers:",e),[]}}async function C(){try{const e=await t.users;return e&&Array.isArray(e)?e.filter((e=>"Client"===e.role)).map((e=>({value:e.id.toString(),label:e.name}))):[]}catch(e){return console.error("Failed to fetch clients:",e),[]}}function w(e){r.value=e,console.log("\n\n valeur",r.value)}async function I(){console.log(n),f.value=!0,d.value="",c.value="",h.value="";const t=new FormData;t.append("name",n.name),t.append("email",n.email),t.append("password",n.password),t.append("role",r.value),t.append("managerId",n.managerId),t.append("clientId",n.clientId),t.append("utilisateurId",n.utilisateurId),t.append("task",n.task),t.append("etat",n.etat),n.photo&&t.append("photo",n.photo);try{console.log(n),await(0,g.kz)(t),e.push({name:"liste"})}catch(a){console.error("Registration failed:",a),h.value="Une erreur est survenue lors de l'inscription. Veuillez réessayer."}finally{f.value=!1}}return(0,o.sV)((async()=>{l.value&&await t.fetchUsers(a.value,l.value),s.value=await k(),i.value=await C()})),console.log("\n\n\n option manager",s.value),{handleRegister:I,formdata:n,filteredMenuItems:y,emailError:d,onFileChange:u,role:a,passwordError:c,apiError:h,userType:r,loading:f,managerOptions:s,clientOptions:i,updateUserType:w}}});var w=a(262);const I=(0,w.A)(C,[["render",c]]),L=I},866:(e,t,a)=>{a.d(t,{P:()=>r});var o=a(615),l=a(6);const r=(0,o.nY)({id:"auth",state:()=>({token:localStorage.getItem("token")||null,userProfile:null,users:[],userList:[],listContract:[],listClients:[],listManagers:[],listUtilisateurs:[],isAuthenticated:!!localStorage.getItem("token")}),actions:{async performLogin(e,t){try{const a=await(0,l.iD)(e,t),o=a.token,r=a.role,n=a.id;this.token=o,localStorage.setItem("token",o),localStorage.setItem("role",r),localStorage.setItem("id",n),this.isAuthenticated=!0,await this.fetchUserProfile(o),await this.fetchUsers(r,o),await this.fetchContract(r,o)}catch(a){throw console.error("Authentication failed:",a),new Error("Login failed")}},async fetchUserProfile(e){if(e)try{const t=await(0,l.VM)(e);this.userProfile=t,this.isAuthenticated=!0}catch(t){console.error("Failed to fetch user profile:",t),this.isAuthenticated=!1}else console.error("No token provided")},async fetchUsers(e,t){if(t)try{const a=await(0,l.ZZ)(e,t);console.log("storage",a),this.users=a,console.log(this.users),this.isAuthenticated=!0}catch(a){console.error("Failed to fetch user:",a),this.isAuthenticated=!1}else console.error("No token provided")},async fetchUsersBY(e,t){if(t)try{const a=await(0,l.lo)(e,t);console.log("storage",a),this.userList=a,console.log("liste ",this.userList)}catch(a){console.error("Failed to fetch user:",a),this.isAuthenticated=!1}else console.error("No token provided")},async fetchContract(e,t){if(t)try{const a=await(0,l.PF)(e,t);console.log("storage",a),this.listContract=a,console.log("liste ",this.listContract)}catch(a){console.error("Failed to fetch user:",a),this.isAuthenticated=!1}else console.error("No token provided")},async performLogout(){if(this.token)try{await(0,l.y4)(this.token),this.isAuthenticated=!1,this.userProfile=null,localStorage.removeItem("token"),localStorage.removeItem("role"),localStorage.removeItem("id")}catch(e){console.error("Failed to logout:",e)}else console.error("No token provided")},async addUser(e){},async fetchUsersByRole(e){if(this.token)try{const t=await(0,l.ZZ)(e,this.token);"client"===e?this.listClients=t:"manager"===e?this.listManagers=t:this.listUtilisateurs=t}catch(t){console.error(`Failed to fetch ${e}s:`,t)}else console.error("No token provided")}}})}}]);
//# sourceMappingURL=329.16e59af9.js.map