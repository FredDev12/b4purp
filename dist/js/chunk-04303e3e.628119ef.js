(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-04303e3e"],{4601:function(e,t,n){"use strict";n.r(t);var o=n("7a23");const c={class:"dashboard"},l={class:"dashboard-container"},r={class:"user-profile"},a={key:0,class:"user-profile"},i={key:0},s=["onClick"],d=["onClick"],u={key:1,class:"user-profile"},b=["onClick"],m=["onClick"],O={key:2,class:"user-profile"},j=["onClick"],p=["onClick"];function k(e,t,n,k,g,E){const h=Object(o["resolveComponent"])("NavBar");return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",c,[Object(o["createVNode"])(h,{menuItems:e.filteredMenuItems},null,8,["menuItems"]),Object(o["createElementVNode"])("main",l,[Object(o["createElementVNode"])("div",null,[Object(o["createElementVNode"])("h1",null,"bonjour, "+Object(o["toDisplayString"])(e.name)+" !",1)]),Object(o["createElementVNode"])("section",r,[t[1]||(t[1]=Object(o["createElementVNode"])("h2",null,"Profil Utilisateur",-1)),Object(o["createElementVNode"])("table",null,[t[0]||(t[0]=Object(o["createElementVNode"])("tr",null,[Object(o["createElementVNode"])("th",null,"Nom"),Object(o["createElementVNode"])("th",null,"Rôle"),Object(o["createElementVNode"])("th",null,"Contract"),Object(o["createElementVNode"])("th",null,"Description")],-1)),Object(o["createElementVNode"])("tr",null,[Object(o["createElementVNode"])("td",null,Object(o["toDisplayString"])(e.store.userProfile.name),1),Object(o["createElementVNode"])("td",null,Object(o["toDisplayString"])(e.store.userProfile.role),1),Object(o["createElementVNode"])("td",null,[(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(e.userContract,e=>(Object(o["openBlock"])(),Object(o["createElementBlock"])("tr",{key:e.id},[Object(o["createElementVNode"])("td",null,Object(o["toDisplayString"])(e.name||"Pas de contrat"),1)]))),128))]),Object(o["createElementVNode"])("td",null,[(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(e.userContract,e=>(Object(o["openBlock"])(),Object(o["createElementBlock"])("tr",{key:e.id},[Object(o["createElementVNode"])("td",null,Object(o["toDisplayString"])(e.description||"Pas de description"),1)]))),128))])])])]),"Client"!==e.role?(Object(o["openBlock"])(),Object(o["createElementBlock"])("section",a,[t[4]||(t[4]=Object(o["createElementVNode"])("h2",null,"Clients",-1)),Object(o["createElementVNode"])("table",null,[Object(o["createElementVNode"])("tr",null,[t[2]||(t[2]=Object(o["createElementVNode"])("th",null,"Nom",-1)),t[3]||(t[3]=Object(o["createElementVNode"])("th",null,"Contrat",-1)),"Manager"!==e.role&&"Utilisateur"!==e.role?(Object(o["openBlock"])(),Object(o["createElementBlock"])("th",i,"Actions")):Object(o["createCommentVNode"])("",!0)]),(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(e.clientList,t=>(Object(o["openBlock"])(),Object(o["createElementBlock"])("tr",{key:t.id},[Object(o["createElementVNode"])("td",null,Object(o["toDisplayString"])(t.name),1),Object(o["createElementVNode"])("td",null,[(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(e.contractForManager,e=>(Object(o["openBlock"])(),Object(o["createElementBlock"])("tr",{key:e.id},[Object(o["createElementVNode"])("td",null,Object(o["toDisplayString"])(e.name||"Pas de contrat"),1)]))),128))]),Object(o["createElementVNode"])("td",null,["Manager"!==e.role&&"Utilisateur"!==e.role?(Object(o["openBlock"])(),Object(o["createElementBlock"])("button",{key:0,onClick:n=>e.editEntity(t.id),class:"edit-button"},"Éditer",8,s)):Object(o["createCommentVNode"])("",!0),"Manager"!==e.role&&"Utilisateur"!==e.role?(Object(o["openBlock"])(),Object(o["createElementBlock"])("button",{key:1,onClick:n=>e.deleteEntity(t.id),class:"delete-button"},"Supprimer",8,d)):Object(o["createCommentVNode"])("",!0)])]))),128))])])):Object(o["createCommentVNode"])("",!0),"Manager"!==e.role?(Object(o["openBlock"])(),Object(o["createElementBlock"])("section",u,[t[6]||(t[6]=Object(o["createElementVNode"])("h2",null,"Managers",-1)),Object(o["createElementVNode"])("table",null,[t[5]||(t[5]=Object(o["createElementVNode"])("tr",null,[Object(o["createElementVNode"])("th",null,"Nom"),Object(o["createElementVNode"])("th",null,"Contrat")],-1)),(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(e.managerList,t=>(Object(o["openBlock"])(),Object(o["createElementBlock"])("tr",{key:t.id},[Object(o["createElementVNode"])("td",null,Object(o["toDisplayString"])(t.name),1),Object(o["createElementVNode"])("td",null,[(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(t.contracts,t=>(Object(o["openBlock"])(),Object(o["createElementBlock"])("tr",{key:t.id},[Object(o["createElementVNode"])("td",null,[Object(o["createTextVNode"])(Object(o["toDisplayString"])(t.name||"Pas de contrat")+" ",1),"Utilisateur"!==e.role?(Object(o["openBlock"])(),Object(o["createElementBlock"])("button",{key:0,onClick:n=>e.editContract(t.id),class:"edit-button"},"Éditer",8,b)):Object(o["createCommentVNode"])("",!0),"Utilisateur"!==e.role?(Object(o["openBlock"])(),Object(o["createElementBlock"])("button",{key:1,onClick:n=>e.deleteContract(t.id),class:"delete-button"},"Supprimer",8,m)):Object(o["createCommentVNode"])("",!0)])]))),128))])]))),128))])])):Object(o["createCommentVNode"])("",!0),"Utilisateur"!==e.role?(Object(o["openBlock"])(),Object(o["createElementBlock"])("section",O,[t[8]||(t[8]=Object(o["createElementVNode"])("h2",null,"Utilisateurs",-1)),Object(o["createElementVNode"])("table",null,[t[7]||(t[7]=Object(o["createElementVNode"])("tr",null,[Object(o["createElementVNode"])("th",null,"Nom"),Object(o["createElementVNode"])("th",null,"Manager"),Object(o["createElementVNode"])("th",null,"Contrat"),Object(o["createElementVNode"])("th",null,"Tache"),Object(o["createElementVNode"])("th",null,"Status"),Object(o["createElementVNode"])("th",null,"Actions")],-1)),(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(e.utilisateurList,t=>(Object(o["openBlock"])(),Object(o["createElementBlock"])("tr",{key:t.id},[Object(o["createElementVNode"])("td",null,Object(o["toDisplayString"])(t.name),1),Object(o["createElementVNode"])("td",null,Object(o["toDisplayString"])(e.store.users.find(e=>t.managerId.includes(e.id))?e.store.users.find(e=>t.managerId.includes(e.id)).name:"Manager Inconnu"),1),Object(o["createElementVNode"])("td",null,[(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(t.contracts,e=>(Object(o["openBlock"])(),Object(o["createElementBlock"])("tr",{key:e.id},[Object(o["createElementVNode"])("td",null,Object(o["toDisplayString"])(e.name||"Pas de contrat"),1)]))),128))]),Object(o["createElementVNode"])("td",null,Object(o["toDisplayString"])(t.task||"Pas de tache"),1),Object(o["createElementVNode"])("td",null,Object(o["toDisplayString"])(t.status),1),Object(o["createElementVNode"])("td",null,[Object(o["createElementVNode"])("button",{onClick:n=>e.editEntity(t.id),class:"edit-button"},"Éditer",8,j),Object(o["createElementVNode"])("button",{onClick:n=>e.deleteEntity(t.id),class:"delete-button"},"Supprimer",8,p)])]))),128))])])):Object(o["createCommentVNode"])("",!0)])])}var g=n("6605"),E=n("5d04"),h=n("e4c3"),N=n("8c07"),f=n("d000"),V=n("3a50"),B=Object(o["defineComponent"])({name:"Dashboard",components:{ButtonComponent:h["a"],SidebarComponent:N["a"],NavBar:f["a"]},data(){return{filteredMenuItems:[],username:"Invité",role:"User"}},setup(){const e=Object(g["c"])(),t=Object(E["a"])(),n=Object(o["ref"])([]),c=Object(o["ref"])(""),l=t.userProfile?t.userProfile.name:"Default Name",r=localStorage.getItem("role")||"Utilisateur",a=localStorage.getItem("token"),i=t.isAuthenticated;let s,d,u,b;const m=t.userProfile.contracts.map(e=>({id:e.id,name:e.name,description:e.description,userId:e.userId}||[]));t.users.map(e=>({id:e.id,name:e.name,email:e.email,role:e.role,clientId:e.clientId,managerId:e.managerId,utilisateurId:e.utilisateurId,status:e.status,task:e.task,contracts:e.contracts.map(e=>({id:e.id,name:e.name,description:e.description,userId:e.userId}))||[]}));if(t.users){s=t.users.filter(e=>"Client"===e.role),d=t.users.filter(e=>"Manager"===e.role),u=t.users.filter(e=>"Utilisateur"===e.role),s.forEach(e=>{if(e.contracts){const t=e.contracts;console.log("\n\n Liste des contrats du client :",t,"\n\n");const n=t.filter(e=>m.some(t=>t.id===e.id));n.length>0?(console.log("\n\n Contrats correspondants pour ce client :"),b=n,console.log("\n\n list liste",b,"\n\n")):console.log("\n\n Aucun contrat correspondant trouvé pour ce client.")}});let e=[],n=[];u.forEach(t=>{if(t.managerId){t.managerId;e=e.concat(t.managerId),n=n.concat(t.id)}})}else console.error("store.users is undefined");console.log("\n\n user actif ",m,"\n\n"),console.log("\n\n client",s,"\n\n"),console.log("\n\n Manager",d,"\n\n"),console.log("\n\n utilisateur",u,"\n\n");const O=Object(o["ref"])([{name:"Tableau de Bord",link:"/dashboard",active:!1,visibleTo:["Admin","Client","Manager","Utilisateur"]},{name:"Liste des Utilisateurs",link:"/liste",active:!1,visibleTo:["Admin","Client","Manager"]},{name:"Mon Profil",link:"/profile",active:!0,visibleTo:["Admin","Client","Manager","Utilisateur"]}]),j=O.value.filter(e=>e.visibleTo.includes(r));Object(o["onMounted"])(async()=>{if(a){console.log(l,"-",r);const e=await Object(V["c"])(r,a);n.value=e,console.log("storage",e)}else console.error("authentication token is missing")});const p=e=>{console.log("Edit entity:",e)},k=e=>{console.log("Delete entity with ID:",e)},h=e=>{console.log("Editing client:",e)},N=e=>{console.log("Editing client:",e)},f=async()=>{e.push({name:"Login"})};return{name:l,role:r,menuItems:O,filteredMenuItems:j,utilisateurList:u,userContract:m,entities:n,entityTitle:c,editEntity:p,contractForManager:b,deleteEntity:k,editContract:h,deleteContract:N,isAuthenticated:i,logout:f,clientList:s,managerList:d,store:t}}}),y=n("6b0d"),C=n.n(y);const v=C()(B,[["render",k]]);t["default"]=v},"5d04":function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var o=n("be92"),c=n("3a50");const l=Object(o["b"])({id:"auth",state:()=>({token:localStorage.getItem("token")||null,userProfile:null,users:[],userList:[],listClients:[],listManagers:[],listUtilisateurs:[],isAuthenticated:!!localStorage.getItem("token")}),actions:{async performLogin(e,t){try{const n=await Object(c["d"])(e,t),o=n.token,l=n.role;this.token=o,localStorage.setItem("token",o),localStorage.setItem("role",l),this.isAuthenticated=!0,await this.fetchUserProfile(o),await this.fetchUsers(l,o)}catch(n){throw console.error("Authentication failed:",n),new Error("Login failed")}},async fetchUserProfile(e){if(e)try{const t=await Object(c["a"])(e);this.userProfile=t,this.isAuthenticated=!0}catch(t){console.error("Failed to fetch user profile:",t),this.isAuthenticated=!1}else console.error("No token provided")},async fetchUsers(e,t){if(t)try{const n=await Object(c["c"])(e,t);console.log("storage",n),this.users=n,console.log(this.users)}catch(n){console.error("Failed to fetch user:",n),this.isAuthenticated=!1}else console.error("No token provided")},async fetchUsersBY(e,t){if(t)try{const n=await Object(c["b"])(e,t);console.log("storage",n),this.userList=n,console.log("liste ",this.userList)}catch(n){console.error("Failed to fetch user:",n),this.isAuthenticated=!1}else console.error("No token provided")},async performLogout(){if(this.token)try{await Object(c["e"])(this.token),this.isAuthenticated=!1,this.userProfile=null,localStorage.removeItem("token"),localStorage.removeItem("role")}catch(e){console.error("Failed to logout:",e)}else console.error("No token provided")},async addUser(e){},async fetchUsersByRole(e){if(this.token)try{const t=await Object(c["c"])(e,this.token);"client"===e?this.listClients=t:"manager"===e?this.listManagers=t:this.listUtilisateurs=t}catch(t){console.error(`Failed to fetch ${e}s:`,t)}else console.error("No token provided")}}})},"8c07":function(e,t,n){"use strict";var o=n("7a23");const c={class:"sidebar"},l=["href"];function r(e,t,n,r,a,i){return Object(o["openBlock"])(),Object(o["createElementBlock"])("aside",c,[Object(o["createElementVNode"])("nav",null,[Object(o["createElementVNode"])("ul",null,[(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(e.menuItems,e=>(Object(o["openBlock"])(),Object(o["createElementBlock"])("li",{key:e.name,class:Object(o["normalizeClass"])({active:e.active})},[Object(o["createElementVNode"])("a",{href:e.link},Object(o["toDisplayString"])(e.name),9,l)],2))),128))])])])}var a=Object(o["defineComponent"])({name:"SidebarComponent",props:{menuItems:{type:Array,required:!0}}}),i=(n("9261"),n("6b0d")),s=n.n(i);const d=s()(a,[["render",r],["__scopeId","data-v-74b7da77"]]);t["a"]=d},9261:function(e,t,n){"use strict";n("d558")},d000:function(e,t,n){"use strict";var o=n("7a23"),c=n("fd5a"),l=n.n(c);const r={class:"navbar"},a={class:"action-bubble"},i={key:0,class:"dropdown-menu"};function s(e,t,n,c,s,d){const u=Object(o["resolveComponent"])("router-link");return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",null,[Object(o["createElementVNode"])("header",r,[t[4]||(t[4]=Object(o["createElementVNode"])("div",{class:"logo"},[Object(o["createElementVNode"])("a",{href:"/"},"MonLogo")],-1)),Object(o["createElementVNode"])("div",{class:Object(o["normalizeClass"])(["menu",{active:e.isMenuOpen}])},[Object(o["createElementVNode"])("ul",null,[(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(e.menuItems,e=>(Object(o["openBlock"])(),Object(o["createElementBlock"])("li",{key:e.name,class:Object(o["normalizeClass"])({active:e.active})},[Object(o["createVNode"])(u,{class:"link",to:e.link},{default:Object(o["withCtx"])(()=>[Object(o["createTextVNode"])(Object(o["toDisplayString"])(e.name),1)]),_:2},1032,["to"])],2))),128))])],2),Object(o["createElementVNode"])("div",a,[Object(o["createElementVNode"])("button",{onClick:t[0]||(t[0]=(...t)=>e.toggleDropdown&&e.toggleDropdown(...t)),class:"action-button"},t[3]||(t[3]=[Object(o["createElementVNode"])("img",{src:l.a,alt:"Profile",class:"profile-picture"},null,-1)])),e.isDropdownOpen?(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",i,[Object(o["createElementVNode"])("ul",null,[Object(o["createElementVNode"])("li",null,[Object(o["createElementVNode"])("a",{href:"#",onClick:t[1]||(t[1]=Object(o["withModifiers"])((...t)=>e.profil&&e.profil(...t),["prevent"]))},"Mon profil")]),Object(o["createElementVNode"])("li",null,[Object(o["createElementVNode"])("a",{href:"#",onClick:t[2]||(t[2]=Object(o["withModifiers"])((...t)=>e.logout&&e.logout(...t),["prevent"]))},"Se déconnecter")])])])):Object(o["createCommentVNode"])("",!0)])])])}var d=n("6605"),u=Object(o["defineComponent"])({name:"NavbarComponent",props:{menuItems:{type:Array,required:!0}},setup(){const e=Object(d["c"])(),t=()=>{localStorage.removeItem("token"),localStorage.removeItem("username"),localStorage.removeItem("role"),e.push("/")},n=()=>{e.push({name:"profile"})};return{logout:t,profil:n}},data(){return{isMenuOpen:!1,isDropdownOpen:!1}},methods:{toggleMenu(){this.isMenuOpen=!this.isMenuOpen},toggleDropdown(){this.isDropdownOpen=!this.isDropdownOpen}}}),b=n("6b0d"),m=n.n(b);const O=m()(u,[["render",s]]);t["a"]=O},d558:function(e,t,n){},fd5a:function(e,t,n){e.exports=n.p+"img/user1.399c5f70.png"}}]);
//# sourceMappingURL=chunk-04303e3e.628119ef.js.map