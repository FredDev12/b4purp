"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[457],{639:(e,t,o)=>{o.d(t,{A:()=>c});var l=o(641);const r={class:"image-upload-container"};function n(e,t,o,n,a,i){return(0,l.uX)(),(0,l.CE)("div",r,[(0,l.Lk)("input",{type:"file",onChange:t[0]||(t[0]=(...t)=>e.handleFileUpload&&e.handleFileUpload(...t)),accept:".png, .jpg, .jpeg, .csv",class:"file-input"},null,32)])}const a=(0,l.pM)({name:"ImageUpload",emits:["update:file"],setup(e,{emit:t}){const o=e=>{const o=e.target,l=o.files,r=l&&l[0];r&&t("update:file",r)};return{handleFileUpload:o}}});var i=o(262);const s=(0,i.A)(a,[["render",n],["__scopeId","data-v-0c012dc8"]]),c=s},189:(e,t,o)=>{o.d(t,{A:()=>m});var l=o(641),r=o(33);const n={class:"input-field"},a=["for"],i=["id","type","value","placeholder","disabled","maxlength","minlength"],s={key:1,class:"error-message"};function c(e,t,o,c,u,d){return(0,l.uX)(),(0,l.CE)("div",n,[e.label?((0,l.uX)(),(0,l.CE)("label",{key:0,for:e.id,class:"input-label"},(0,r.v_)(e.label),9,a)):(0,l.Q3)("",!0),(0,l.Lk)("input",{id:e.id,type:e.type,value:e.modelValue,placeholder:e.placeholder,disabled:e.disabled,maxlength:e.maxlength,minlength:e.minlength,onInput:t[0]||(t[0]=t=>e.$emit("update:modelValue",t.target.value)),class:"input"},null,40,i),e.errorMessage?((0,l.uX)(),(0,l.CE)("p",s,(0,r.v_)(e.errorMessage),1)):(0,l.Q3)("",!0)])}const u=(0,l.pM)({name:"InputField",props:{id:{type:String,required:!0},label:{type:String,required:!0},type:{type:String,default:"text"},modelValue:{type:String,required:!0},placeholder:{type:String,required:!0},disabled:{type:Boolean,required:!1,default:!1},maxlength:{type:Number,required:!1},minlength:{type:Number,required:!1},errorMessage:{type:String,required:!1}}});var d=o(262);const p=(0,d.A)(u,[["render",c],["__scopeId","data-v-493aa504"]]),m=p},939:(e,t,o)=>{o.d(t,{A:()=>v});var l=o(641),r=o(33),n=o(751);const a=o.p+"img/user1.8b23ecd3.png",i={class:"navbar"},s={class:"action-bubble"},c={class:"welcom"},u={key:0,class:"dropdown-menu"};function d(e,t,o,d,p,m){const g=(0,l.g2)("router-link");return(0,l.uX)(),(0,l.CE)("div",null,[(0,l.Lk)("header",i,[t[4]||(t[4]=(0,l.Lk)("div",{class:"logo"},[(0,l.Lk)("a",{href:"/"},"MonLogo")],-1)),(0,l.Lk)("div",{class:(0,r.C4)(["menu",{active:e.isMenuOpen}])},[(0,l.Lk)("ul",null,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(e.menuItems,(e=>((0,l.uX)(),(0,l.CE)("li",{key:e.name,class:(0,r.C4)({active:e.active})},[(0,l.bF)(g,{class:"link",to:e.link},{default:(0,l.k6)((()=>[(0,l.eW)((0,r.v_)(e.name),1)])),_:2},1032,["to"])],2)))),128))])],2),(0,l.Lk)("div",s,[(0,l.Lk)("h1",c,"Bonjour, "+(0,r.v_)(e.username)+" !",1),(0,l.Lk)("button",{onClick:t[0]||(t[0]=(...t)=>e.toggleDropdown&&e.toggleDropdown(...t)),class:"action-button"},t[3]||(t[3]=[(0,l.Lk)("img",{src:a,alt:"Profile",class:"profile-picture"},null,-1)])),e.isDropdownOpen?((0,l.uX)(),(0,l.CE)("div",u,[(0,l.Lk)("ul",null,[(0,l.Lk)("li",null,[(0,l.Lk)("a",{href:"#",onClick:t[1]||(t[1]=(0,n.D$)(((...t)=>e.profil&&e.profil(...t)),["prevent"]))},"Mon profil")]),(0,l.Lk)("li",null,[(0,l.Lk)("a",{href:"#",onClick:t[2]||(t[2]=(0,n.D$)(((...t)=>e.logout&&e.logout(...t)),["prevent"]))},"Se déconnecter")])])])):(0,l.Q3)("",!0)])])])}var p=o(220),m=o(866);const g=(0,l.pM)({name:"NavbarComponent",props:{menuItems:{type:Array,required:!0}},setup(){const e=(0,p.rd)(),t=(0,m.P)(),o=t.userProfile?t.userProfile.name:"Default Name",l=()=>{localStorage.removeItem("token"),localStorage.removeItem("username"),localStorage.removeItem("role"),e.push("/")},r=()=>{e.push({name:"profile"})};return{logout:l,profil:r,username:o}},data(){return{isMenuOpen:!1,isDropdownOpen:!1}},methods:{toggleMenu(){this.isMenuOpen=!this.isMenuOpen},toggleDropdown(){this.isDropdownOpen=!this.isDropdownOpen}}});var h=o(262);const f=(0,h.A)(g,[["render",d]]),v=f},475:(e,t,o)=>{o.d(t,{A:()=>m});var l=o(641),r=o(33),n=o(751);const a={for:"select",class:"select-label"},i=["id"],s=["value"];function c(e,t,o,c,u,d){return(0,l.uX)(),(0,l.CE)("div",null,[(0,l.Lk)("label",a,(0,r.v_)(e.label),1),(0,l.bo)((0,l.Lk)("select",{"onUpdate:modelValue":t[0]||(t[0]=t=>e.selectedOption=t),class:"gender-select",id:e.uniqueId},[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(e.options,(e=>((0,l.uX)(),(0,l.CE)("option",{key:e.value,value:e.value},(0,r.v_)(e.label),9,s)))),128))],8,i),[[n.u1,e.selectedOption]])])}const u=(0,l.pM)({name:"SelectComponent",props:{modelValue:{type:String,required:!1},options:{type:Array,required:!0},label:{type:String,default:"Sélectionnez une option"},id:{type:String,default:""}},emits:["update:modelValue"],setup(e,{emit:t}){const o=(0,l.EW)((()=>e.id||`select-${Math.random().toString(36).substr(2,9)}`)),r=(0,l.EW)({get:()=>e.modelValue,set:e=>t("update:modelValue",e)});return{selectedOption:r,options:e.options,uniqueId:o}}});var d=o(262);const p=(0,d.A)(u,[["render",c],["__scopeId","data-v-e67af60c"]]),m=p},816:(e,t,o)=>{o.r(t),o.d(t,{default:()=>I});var l=o(641),r=o(751),n=o(33);const a={class:"register"},i={class:"form-group"},s={key:0,class:"error"};function c(e,t,o,c,u,d){const p=(0,l.g2)("NavBar"),m=(0,l.g2)("InputField"),g=(0,l.g2)("ButtonComponent");return(0,l.uX)(),(0,l.CE)(l.FK,null,[(0,l.bF)(p,{menuItems:e.filteredMenuItems},null,8,["menuItems"]),(0,l.Lk)("div",a,[t[3]||(t[3]=(0,l.Lk)("h1",null,"Ajouter un Contract",-1)),(0,l.Lk)("form",{onSubmit:t[2]||(t[2]=(0,r.D$)(((...t)=>e.handleRegister&&e.handleRegister(...t)),["prevent"]))},[(0,l.Lk)("div",i,[(0,l.bF)(m,{id:"name",label:"Nom",modelValue:e.formdata.name,"onUpdate:modelValue":t[0]||(t[0]=t=>e.formdata.name=t),type:"text",placeholder:"Nom",required:""},null,8,["modelValue"]),(0,l.bF)(m,{id:"description",label:"description",modelValue:e.formdata.description,"onUpdate:modelValue":t[1]||(t[1]=t=>e.formdata.description=t),type:"text",placeholder:"Votre description",required:""},null,8,["modelValue"])]),(0,l.bF)(g,{type:"submit",class:"btn-primary",disabled:e.loading},{default:(0,l.k6)((()=>[e.loading?((0,l.uX)(),(0,l.CE)(l.FK,{key:0},[(0,l.eW)("Chargement...")],64)):((0,l.uX)(),(0,l.CE)(l.FK,{key:1},[(0,l.eW)("Ajouter")],64))])),_:1},8,["disabled"]),e.apiError?((0,l.uX)(),(0,l.CE)("p",s,(0,n.v_)(e.apiError),1)):(0,l.Q3)("",!0)],32)])],64)}var u=o(953),d=o(220),p=o(6),m=o(523),g=o(189),h=o(475),f=o(639),v=o(939),k=o(866);const y=(0,l.pM)({name:"Register",components:{ButtonComponent:m.A,InputField:g.A,SelectComponent:h.A,ImageUpload:f.A,NavBar:v.A},setup(){const e=(0,d.rd)(),t=((0,k.P)(),(0,u.KR)(localStorage.getItem("role")||"Utilisateur")),o=((0,u.KR)(localStorage.getItem("token")),(0,u.KR)("Utilisateur"),(0,u.Kh)({name:"",description:""})),r=(0,u.KR)(""),n=(0,u.KR)(!1),a=(0,u.KR)([{name:"Tableau de Bord",link:"/dashboard",active:!1,visibleTo:["Admin","Client","Manager","Utilisateur"]},{name:"Liste des Utilisateurs",link:"/liste",active:!1,visibleTo:["Admin","Client","Manager"]},{name:"Liste des Contract",link:"/contract",active:!0,visibleTo:["Admin","Client"]}]),i=(0,l.EW)((()=>a.value.filter((e=>e.visibleTo.includes(t.value)))));async function s(){console.log(o),n.value=!0,r.value="";const t=new FormData;t.append("name",o.name),t.append("description",o.description);try{console.log(o),await(0,p.g)(t),e.push({name:"contract"})}catch(l){console.error("Registration failed:",l),r.value="Une erreur est survenue lors de l'inscription. Veuillez réessayer."}finally{n.value=!1}}return{handleRegister:s,formdata:o,filteredMenuItems:i,role:t,apiError:r,loading:n}}});var b=o(262);const C=(0,b.A)(y,[["render",c]]),I=C},866:(e,t,o)=>{o.d(t,{P:()=>n});var l=o(615),r=o(6);const n=(0,l.nY)({id:"auth",state:()=>({token:localStorage.getItem("token")||null,userProfile:null,users:[],userList:[],listContract:[],listClients:[],listManagers:[],listUtilisateurs:[],isAuthenticated:!!localStorage.getItem("token")}),actions:{async performLogin(e,t){try{const o=await(0,r.iD)(e,t),l=o.token,n=o.role,a=o.id;this.token=l,localStorage.setItem("token",l),localStorage.setItem("role",n),localStorage.setItem("id",a),this.isAuthenticated=!0,await this.fetchUserProfile(l),await this.fetchUsers(n,l),await this.fetchContract(n,l)}catch(o){throw console.error("Authentication failed:",o),new Error("Login failed")}},async fetchUserProfile(e){if(e)try{const t=await(0,r.VM)(e);this.userProfile=t,this.isAuthenticated=!0}catch(t){console.error("Failed to fetch user profile:",t),this.isAuthenticated=!1}else console.error("No token provided")},async fetchUsers(e,t){if(t)try{const o=await(0,r.ZZ)(e,t);console.log("storage",o),this.users=o,console.log(this.users),this.isAuthenticated=!0}catch(o){console.error("Failed to fetch user:",o),this.isAuthenticated=!1}else console.error("No token provided")},async fetchUsersBY(e,t){if(t)try{const o=await(0,r.lo)(e,t);console.log("storage",o),this.userList=o,console.log("liste ",this.userList)}catch(o){console.error("Failed to fetch user:",o),this.isAuthenticated=!1}else console.error("No token provided")},async fetchContract(e,t){if(t)try{const o=await(0,r.PF)(e,t);console.log("storage",o),this.listContract=o,console.log("liste ",this.listContract)}catch(o){console.error("Failed to fetch user:",o),this.isAuthenticated=!1}else console.error("No token provided")},async performLogout(){if(this.token)try{await(0,r.y4)(this.token),this.isAuthenticated=!1,this.userProfile=null,localStorage.removeItem("token"),localStorage.removeItem("role"),localStorage.removeItem("id")}catch(e){console.error("Failed to logout:",e)}else console.error("No token provided")},async addUser(e){},async fetchUsersByRole(e){if(this.token)try{const t=await(0,r.ZZ)(e,this.token);"client"===e?this.listClients=t:"manager"===e?this.listManagers=t:this.listUtilisateurs=t}catch(t){console.error(`Failed to fetch ${e}s:`,t)}else console.error("No token provided")}}})}}]);
//# sourceMappingURL=457.756b3212.js.map