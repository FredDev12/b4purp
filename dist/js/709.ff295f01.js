"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[709],{939:(e,t,o)=>{o.d(t,{A:()=>g});var n=o(641),s=o(33),l=o(751);const i=o.p+"img/user1.8b23ecd3.png",r={class:"navbar"},a={class:"action-bubble"},c={class:"welcom"},u={key:0,class:"dropdown-menu"};function d(e,t,o,d,h,k){const m=(0,n.g2)("router-link");return(0,n.uX)(),(0,n.CE)("div",null,[(0,n.Lk)("header",r,[t[4]||(t[4]=(0,n.Lk)("div",{class:"logo"},[(0,n.Lk)("a",{href:"/"},"MonLogo")],-1)),(0,n.Lk)("div",{class:(0,s.C4)(["menu",{active:e.isMenuOpen}])},[(0,n.Lk)("ul",null,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(e.menuItems,(e=>((0,n.uX)(),(0,n.CE)("li",{key:e.name,class:(0,s.C4)({active:e.active})},[(0,n.bF)(m,{class:"link",to:e.link},{default:(0,n.k6)((()=>[(0,n.eW)((0,s.v_)(e.name),1)])),_:2},1032,["to"])],2)))),128))])],2),(0,n.Lk)("div",a,[(0,n.Lk)("h1",c,"Bonjour, "+(0,s.v_)(e.username)+" !",1),(0,n.Lk)("button",{onClick:t[0]||(t[0]=(...t)=>e.toggleDropdown&&e.toggleDropdown(...t)),class:"action-button"},t[3]||(t[3]=[(0,n.Lk)("img",{src:i,alt:"Profile",class:"profile-picture"},null,-1)])),e.isDropdownOpen?((0,n.uX)(),(0,n.CE)("div",u,[(0,n.Lk)("ul",null,[(0,n.Lk)("li",null,[(0,n.Lk)("a",{href:"#",onClick:t[1]||(t[1]=(0,l.D$)(((...t)=>e.profil&&e.profil(...t)),["prevent"]))},"Mon profil")]),(0,n.Lk)("li",null,[(0,n.Lk)("a",{href:"#",onClick:t[2]||(t[2]=(0,l.D$)(((...t)=>e.logout&&e.logout(...t)),["prevent"]))},"Se déconnecter")])])])):(0,n.Q3)("",!0)])])])}var h=o(220),k=o(866);const m=(0,n.pM)({name:"NavbarComponent",props:{menuItems:{type:Array,required:!0}},setup(){const e=(0,h.rd)(),t=(0,k.P)(),o=t.userProfile?t.userProfile.name:"Default Name",n=()=>{localStorage.removeItem("token"),localStorage.removeItem("username"),localStorage.removeItem("role"),e.push("/")},s=()=>{e.push({name:"profile"})};return{logout:n,profil:s,username:o}},data(){return{isMenuOpen:!1,isDropdownOpen:!1}},methods:{toggleMenu(){this.isMenuOpen=!this.isMenuOpen},toggleDropdown(){this.isDropdownOpen=!this.isDropdownOpen}}});var p=o(262);const v=(0,p.A)(m,[["render",d]]),g=v},347:(e,t,o)=>{o.d(t,{A:()=>d});var n=o(641),s=o(33);const l={class:"sidebar"},i=["href"];function r(e,t,o,r,a,c){return(0,n.uX)(),(0,n.CE)("aside",l,[(0,n.Lk)("nav",null,[(0,n.Lk)("ul",null,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(e.menuItems,(e=>((0,n.uX)(),(0,n.CE)("li",{key:e.name,class:(0,s.C4)({active:e.active})},[(0,n.Lk)("a",{href:e.link},(0,s.v_)(e.name),9,i)],2)))),128))])])])}const a=(0,n.pM)({name:"SidebarComponent",props:{menuItems:{type:Array,required:!0}}});var c=o(262);const u=(0,c.A)(a,[["render",r],["__scopeId","data-v-8ce43eac"]]),d=u},84:(e,t,o)=>{o.r(t),o.d(t,{default:()=>b});var n=o(641),s=o(33);const l={class:"dashboard"},i={class:"table-container"},r={key:0,class:"client-table"},a=["onClick"],c=["onClick"],u={key:1};function d(e,t,o,d,h,k){const m=(0,n.g2)("NavBar"),p=(0,n.g2)("router-link");return(0,n.uX)(),(0,n.CE)("div",l,[(0,n.bF)(m,{menuItems:e.filteredMenuItems},null,8,["menuItems"]),(0,n.Lk)("main",i,[t[4]||(t[4]=(0,n.Lk)("h1",null,"Liste des Utilisateurs",-1)),(0,n.Lk)("button",{class:"add-button",onClick:t[0]||(t[0]=t=>e.addUser())},"Ajouter"),e.entities.length>0?((0,n.uX)(),(0,n.CE)("table",r,[t[1]||(t[1]=(0,n.Lk)("thead",null,[(0,n.Lk)("tr",null,[(0,n.Lk)("th",null,"Nom complet"),(0,n.Lk)("th",null,"Email"),(0,n.Lk)("th",null,"Tache"),(0,n.Lk)("th",null,"Status"),(0,n.Lk)("th",null,"Rôle"),(0,n.Lk)("th",null,"Actions")])],-1)),(0,n.Lk)("tbody",null,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(e.entities,(t=>((0,n.uX)(),(0,n.CE)("tr",{key:t.id},[(0,n.Lk)("td",null,(0,s.v_)(t.name),1),(0,n.Lk)("td",null,(0,s.v_)(t.email),1),(0,n.Lk)("td",null,(0,s.v_)(t.task),1),(0,n.Lk)("td",null,(0,s.v_)(t.status),1),(0,n.Lk)("td",null,(0,s.v_)(t.role),1),(0,n.Lk)("td",null,[(0,n.Lk)("button",{onClick:o=>e.editEntity(t.id),class:"edit-button"},"Éditer",8,a),(0,n.Lk)("button",{onClick:o=>e.deleteEntity(t.id),class:"delete-button"},"Supprimer",8,c)])])))),128))])])):((0,n.uX)(),(0,n.CE)("p",u,[(0,n.eW)("Aucun "+(0,s.v_)(e.entityTitle.toLowerCase())+" trouvé ",1),(0,n.bF)(p,{to:"/addUser"},{default:(0,n.k6)((()=>t[2]||(t[2]=[(0,n.eW)("Ajouter ici")]))),_:1}),t[3]||(t[3]=(0,n.eW)("."))]))])])}var h=o(953),k=o(523),m=o(347),p=o(939),v=o(220),g=o(6),f=o(866);const L=(0,n.pM)({name:"List",components:{ButtonComponent:k.A,SidebarComponent:m.A,NavBar:p.A},setup(){(0,f.P)();const e=(0,h.KR)([]),t=(0,h.KR)(""),o=localStorage.getItem("role")||"Utilisateur",s=localStorage.getItem("token"),l=(0,h.KR)([{name:"Tableau de Bord",link:"/dashboard",active:!1,visibleTo:["Admin","Client","Manager","Utilisateur"]},{name:"Liste des Utilisateurs",link:"/liste",active:!1,visibleTo:["Admin","Client","Manager"]},{name:"Liste des contract",link:"/contract",active:!0,visibleTo:["Admin","Client"]}]),i=l.value.filter((e=>e.visibleTo.includes(o))),r=(0,v.rd)();(0,n.sV)((async()=>{try{const n=o;switch(n){case"Admin":t.value="Admin";break;case"Client":t.value="Client";break;case"Manager":t.value="Manager";break;case"Utilisateur":t.value="Utilisateur";break;default:return void console.warn(`Type d'entité inconnu: ${n}`)}if(console.log(t.value),s){const t=await(0,g.lo)(o,s);console.log(o),e.value=t}else console.error("authentication token is missing")}catch(n){console.error("Une erreur est survenue lors de la récupération des données.",n)}}));const a=e=>{console.log("Edit entity:",e)},c=e=>{console.log("Delete entity with ID:",e)},u=()=>{r.push("/addUser")};return{entities:e,entityTitle:t,menuItems:l,editEntity:a,deleteEntity:c,addUser:u,filteredMenuItems:i,role:o}}});var C=o(262);const y=(0,C.A)(L,[["render",d]]),b=y},866:(e,t,o)=>{o.d(t,{P:()=>l});var n=o(615),s=o(6);const l=(0,n.nY)({id:"auth",state:()=>({token:localStorage.getItem("token")||null,userProfile:null,users:[],userList:[],listContract:[],listClients:[],listManagers:[],listUtilisateurs:[],isAuthenticated:!!localStorage.getItem("token")}),actions:{async performLogin(e,t){try{const o=await(0,s.iD)(e,t),n=o.token,l=o.role,i=o.id;this.token=n,localStorage.setItem("token",n),localStorage.setItem("role",l),localStorage.setItem("id",i),this.isAuthenticated=!0,await this.fetchUserProfile(n),await this.fetchUsers(l,n),await this.fetchContract(l,n)}catch(o){throw console.error("Authentication failed:",o),new Error("Login failed")}},async fetchUserProfile(e){if(e)try{const t=await(0,s.VM)(e);this.userProfile=t,this.isAuthenticated=!0}catch(t){console.error("Failed to fetch user profile:",t),this.isAuthenticated=!1}else console.error("No token provided")},async fetchUsers(e,t){if(t)try{const o=await(0,s.ZZ)(e,t);console.log("storage",o),this.users=o,console.log(this.users),this.isAuthenticated=!0}catch(o){console.error("Failed to fetch user:",o),this.isAuthenticated=!1}else console.error("No token provided")},async fetchUsersBY(e,t){if(t)try{const o=await(0,s.lo)(e,t);console.log("storage",o),this.userList=o,console.log("liste ",this.userList)}catch(o){console.error("Failed to fetch user:",o),this.isAuthenticated=!1}else console.error("No token provided")},async fetchContract(e,t){if(t)try{const o=await(0,s.PF)(e,t);console.log("storage",o),this.listContract=o,console.log("liste ",this.listContract)}catch(o){console.error("Failed to fetch user:",o),this.isAuthenticated=!1}else console.error("No token provided")},async performLogout(){if(this.token)try{await(0,s.y4)(this.token),this.isAuthenticated=!1,this.userProfile=null,localStorage.removeItem("token"),localStorage.removeItem("role"),localStorage.removeItem("id")}catch(e){console.error("Failed to logout:",e)}else console.error("No token provided")},async addUser(e){},async fetchUsersByRole(e){if(this.token)try{const t=await(0,s.ZZ)(e,this.token);"client"===e?this.listClients=t:"manager"===e?this.listManagers=t:this.listUtilisateurs=t}catch(t){console.error(`Failed to fetch ${e}s:`,t)}else console.error("No token provided")}}})}}]);
//# sourceMappingURL=709.ff295f01.js.map